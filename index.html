
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Complete image processing suite - Resize, Compress, Crop, Convert, and Optimize images online with real processing">
    <meta name="keywords" content="image resize, image compress, image crop, image convert, image optimizer, batch processing">
    <meta name="author" content="FastResizePro">
    <meta name="google-site-verification" content="doDleI5gM_PdDKrOGrMKgHP5Mp2z6bo7kDlffOJcZh8" />
    <title>FastResizePro - Complete Image Processing Suite</title>
    
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- JSZip -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --primary-light: #60a5fa;
            --secondary: #7c3aed;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #0f172a;
            --darker: #0a0f1e;
            --light: #f8fafc;
            --gray: #64748b;
            --gray-light: #e2e8f0;
            --border: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Header Styles */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header-content {
            max-width: 1440px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 2rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-decoration: none;
        }

        .logo i {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 1.75rem;
        }

        /* Search Bar */
        .search-container {
            flex: 1;
            max-width: 500px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 3rem;
            border: 2px solid var(--gray-light);
            border-radius: 50px;
            font-size: 0.95rem;
            transition: all 0.3s;
            background: white;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border-radius: 12px;
            margin-top: 0.5rem;
            box-shadow: var(--shadow-lg);
            max-height: 400px;
            overflow-y: auto;
            display: none;
            z-index: 1000;
        }

        .search-results.active {
            display: block;
        }

        .search-result-item {
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 1px solid var(--gray-light);
        }

        .search-result-item:hover {
            background: var(--gray-light);
        }

        .search-result-item i {
            color: var(--primary);
            width: 20px;
        }

        /* Navigation Menu */
        .nav-menu {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .dropdown {
            position: relative;
        }

        .dropdown-btn {
            background: none;
            border: none;
            padding: 0.5rem 1rem;
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--dark);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .dropdown-btn:hover {
            background: var(--gray-light);
            color: var(--primary);
        }

        .dropdown-content {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            min-width: 280px;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            padding: 0.75rem;
            display: none;
            z-index: 100;
            max-height: 500px;
            overflow-y: auto;
        }

        .dropdown.active .dropdown-content {
            display: block;
        }

        .dropdown-item {
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--dark);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .dropdown-item:hover {
            background: var(--gray-light);
            color: var(--primary);
            transform: translateX(5px);
        }

        .dropdown-item i {
            width: 20px;
            color: var(--primary);
        }

        .dropdown-category {
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--gray);
            letter-spacing: 1px;
        }

        /* Main Content */
        .main-content {
            max-width: 1440px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        /* Tool Container */
        .tool-container {
            background: white;
            border-radius: 24px;
            box-shadow: var(--shadow-lg);
            padding: 2rem;
            margin-bottom: 2rem;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tool-header {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--gray-light);
        }

        .tool-title {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .tool-description {
            color: var(--gray);
            font-size: 1rem;
        }

        /* Upload Area */
        .upload-area {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 3rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            color: white;
        }

        .upload-area::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.2) 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .upload-area:hover::before {
            opacity: 1;
        }

        .upload-area.dragover {
            transform: scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .upload-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            color: white;
        }

        .upload-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .upload-subtitle {
            font-size: 0.95rem;
            opacity: 0.9;
        }

        /* Controls Grid */
        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .control-group {
            background: white;
            border: 2px solid var(--gray-light);
            border-radius: 16px;
            padding: 1.5rem;
        }

        .control-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--dark);
        }

        .control-label i {
            color: var(--primary);
        }

        .input-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .input-group label {
            min-width: 80px;
            color: var(--gray);
            font-size: 0.9rem;
        }

        .input-field {
            flex: 1;
            padding: 0.75rem;
            border: 2px solid var(--gray-light);
            border-radius: 8px;
            font-size: 0.95rem;
            transition: all 0.2s;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .input-field[type="range"] {
            padding: 0;
            accent-color: var(--primary);
        }

        /* Button Styles */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(37, 99, 235, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #0d9488);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        .btn-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1.5rem;
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .quick-action {
            background: white;
            border: 2px solid var(--gray-light);
            border-radius: 16px;
            padding: 1.25rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            color: var(--dark);
        }

        .quick-action:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .quick-action i {
            font-size: 1.75rem;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .quick-action span {
            display: block;
            font-weight: 600;
        }

        /* Preview Section */
        .preview-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .preview-card {
            background: white;
            border: 2px solid var(--gray-light);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
        }

        .preview-card h4 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            color: var(--dark);
        }

        .preview-image {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            box-shadow: var(--shadow);
        }

        .preview-info {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--gray-light);
            font-size: 0.9rem;
            color: var(--gray);
        }

        /* Aspect Ratio Grid */
        .aspect-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 0.75rem;
            margin-top: 1rem;
            max-height: 300px;
            overflow-y: auto;
            padding: 0.5rem;
        }

        .aspect-btn {
            padding: 0.5rem;
            background: white;
            border: 2px solid var(--gray-light);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.85rem;
        }

        .aspect-btn:hover {
            border-color: var(--primary);
            background: rgba(37, 99, 235, 0.05);
        }

        .aspect-btn.active {
            border-color: var(--primary);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        /* Progress Bar */
        .progress-container {
            display: none;
            margin-top: 2rem;
        }

        .progress-container.active {
            display: block;
        }

        .progress-bar {
            height: 8px;
            background: var(--gray-light);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            width: 0%;
            transition: width 0.3s;
            border-radius: 10px;
        }

        .progress-stats {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: var(--gray);
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
        }

        .toast {
            background: white;
            border-radius: 12px;
            padding: 1rem 1.5rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 1rem;
            animation: slideIn 0.3s ease;
            max-width: 400px;
        }

        .toast.success {
            border-left: 4px solid var(--success);
        }

        .toast.error {
            border-left: 4px solid var(--danger);
        }

        .toast.warning {
            border-left: 4px solid var(--warning);
        }

        .toast i {
            font-size: 1.25rem;
        }

        .toast.success i {
            color: var(--success);
        }

        .toast.error i {
            color: var(--danger);
        }

        .toast.warning i {
            color: var(--warning);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(37, 99, 235, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .header-content {
                flex-direction: column;
                padding: 1rem;
            }
            
            .search-container {
                max-width: 100%;
            }
            
            .nav-menu {
                width: 100%;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .main-content {
                padding: 0 1rem;
            }
        }

        @media (max-width: 768px) {
            .controls-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .tool-title {
                font-size: 1.5rem;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }

        /* EXIF Viewer */
        .exif-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }

        .exif-data {
            background: var(--gray-light);
            border-radius: 12px;
            padding: 1.5rem;
            font-family: monospace;
            font-size: 0.9rem;
            overflow-x: auto;
        }

        .exif-row {
            display: flex;
            padding: 0.5rem;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }

        .exif-label {
            font-weight: 700;
            width: 150px;
            color: var(--dark);
        }

        .exif-value {
            color: var(--gray);
        }

        /* DPI Calculator */
        .dpi-calculator {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 1.5rem;
            color: white;
        }

        .dpi-result {
            font-size: 1.5rem;
            font-weight: 700;
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
        }

        /* Hide default */
        [data-page] {
            display: none;
        }

        [data-page].active {
            display: block;
        }

        /* Breadcrumb */
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            color: white;
        }

        .breadcrumb a {
            color: white;
            text-decoration: none;
            opacity: 0.8;
            transition: opacity 0.2s;
        }

        .breadcrumb a:hover {
            opacity: 1;
        }

        .breadcrumb i {
            font-size: 0.75rem;
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo" onclick="showPage('home')">
                <i class="fas fa-bolt"></i>
                FastResizePro
            </a>

            <!-- Search Bar -->
            <div class="search-container">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" id="globalSearch" placeholder="Search tools (e.g., resize, compress, crop...)" autocomplete="off">
                <div class="search-results" id="searchResults"></div>
            </div>

            <!-- Navigation Menu with Dropdowns -->
            <nav class="nav-menu">
                <div class="dropdown" id="imageToolsDropdown">
                    <button class="dropdown-btn" onclick="toggleDropdown('imageToolsDropdown')">
                        <i class="fas fa-tools"></i> Image Tools <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="dropdown-content">
                        <div class="dropdown-category">RESIZE & SCALE</div>
                        <a href="#" class="dropdown-item" onclick="showPage('resize-percentage')"><i class="fas fa-percent"></i> Resize by Percentage</a>
                        <a href="#" class="dropdown-item" onclick="showPage('resize-aspect-ratio')"><i class="fas fa-arrows-alt"></i> Advanced Resize + Aspect</a>
                        <a href="#" class="dropdown-item" onclick="showPage('resize-dimensions')"><i class="fas fa-ruler"></i> Resize with DPI</a>
                        <a href="#" class="dropdown-item" onclick="showPage('upscale-image')"><i class="fas fa-expand"></i> Upscale Image</a>
                        
                        <div class="dropdown-category">COMPRESS & OPTIMIZE</div>
                        <a href="#" class="dropdown-item" onclick="showPage('compress-image')"><i class="fas fa-compress"></i> Compress Image</a>
                        <a href="#" class="dropdown-item" onclick="showPage('optimize-image')"><i class="fas fa-magic"></i> Optimize Image</a>
                        <a href="#" class="dropdown-item" onclick="showPage('resize-to-kb')"><i class="fas fa-file"></i> Resize to KB</a>
                        
                        <div class="dropdown-category">CROP & TRANSFORM</div>
                        <a href="#" class="dropdown-item" onclick="showPage('crop-image')"><i class="fas fa-crop"></i> Crop Image</a>
                        <a href="#" class="dropdown-item" onclick="showPage('rotate-image')"><i class="fas fa-undo-alt"></i> Rotate Image</a>
                        <a href="#" class="dropdown-item" onclick="showPage('mirror-image')"><i class="fas fa-arrows-alt-h"></i> Mirror Image</a>
                        <a href="#" class="dropdown-item" onclick="showPage('pixelate-image')"><i class="fas fa-th"></i> Pixelate Image</a>
                        
                        <div class="dropdown-category">CONVERT & EXPORT</div>
                        <a href="#" class="dropdown-item" onclick="showPage('convert-to-webp')"><i class="fas fa-file-image"></i> Convert to WebP</a>
                        
                        <div class="dropdown-category">WATERMARK & METADATA</div>
                        <a href="#" class="dropdown-item" onclick="showPage('add-watermark')"><i class="fas fa-copyright"></i> Add Watermark</a>
                        <a href="#" class="dropdown-item" onclick="showPage('exif-viewer')"><i class="fas fa-info-circle"></i> EXIF Viewer</a>
                    </div>
                </div>

                <div class="dropdown" id="socialToolsDropdown">
                    <button class="dropdown-btn" onclick="toggleDropdown('socialToolsDropdown')">
                        <i class="fas fa-share-alt"></i> Social Media <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="dropdown-content">
                        <div class="dropdown-category">PLATFORM PRESETS</div>
                        <a href="#" class="dropdown-item" onclick="showPage('social-media-resizer')"><i class="fas fa-instagram"></i> Instagram</a>
                        <a href="#" class="dropdown-item" onclick="showPage('social-media-resizer')"><i class="fab fa-facebook"></i> Facebook</a>
                        <a href="#" class="dropdown-item" onclick="showPage('social-media-resizer')"><i class="fab fa-twitter"></i> Twitter</a>
                        <a href="#" class="dropdown-item" onclick="showPage('social-media-resizer')"><i class="fab fa-linkedin"></i> LinkedIn</a>
                        <a href="#" class="dropdown-item" onclick="showPage('social-media-resizer')"><i class="fab fa-youtube"></i> YouTube</a>
                        <a href="#" class="dropdown-item" onclick="showPage('social-media-resizer')"><i class="fab fa-pinterest"></i> Pinterest</a>
                    </div>
                </div>

                <div class="dropdown" id="printToolsDropdown">
                    <button class="dropdown-btn" onclick="toggleDropdown('printToolsDropdown')">
                        <i class="fas fa-print"></i> Print & Batch <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="dropdown-content">
                        <div class="dropdown-category">PRINT SIZES</div>
                        <a href="#" class="dropdown-item" onclick="showPage('print-resize')"><i class="fas fa-file"></i> Print Resize</a>
                        <a href="#" class="dropdown-item" onclick="showPage('dimension-calculator')"><i class="fas fa-calculator"></i> Dimension Calculator</a>
                        
                        <div class="dropdown-category">BATCH PROCESSING</div>
                        <a href="#" class="dropdown-item" onclick="showPage('batch-resize')"><i class="fas fa-layer-group"></i> Batch Resize</a>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Breadcrumb -->
        <div class="breadcrumb" id="breadcrumb">
            <a href="#" onclick="showPage('home')">Home</a>
            <i class="fas fa-chevron-right"></i>
            <span id="currentPageName">Dashboard</span>
        </div>

        <!-- Toast Container -->
        <div class="toast-container" id="toastContainer"></div>

        <!-- HOME PAGE -->
        <div data-page="home" class="active">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Complete Image Processing Suite</h1>
                    <p class="tool-description">Professional tools for all your image editing needs. 100% free, no registration required.</p>
                </div>

                <!-- Quick Actions -->
                <h2 style="margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-bolt" style="color: var(--primary);"></i>
                    Quick Actions
                </h2>
                <div class="quick-actions">
                    <a href="#" class="quick-action" onclick="showPage('compress-image')">
                        <i class="fas fa-compress-alt"></i>
                        <span>Compress Image</span>
                    </a>
                    <a href="#" class="quick-action" onclick="showPage('crop-image')">
                        <i class="fas fa-crop"></i>
                        <span>Crop Image</span>
                    </a>
                    <a href="#" class="quick-action" onclick="showPage('rotate-image')">
                        <i class="fas fa-redo-alt"></i>
                        <span>Rotate Image</span>
                    </a>
                    <a href="#" class="quick-action" onclick="showPage('convert-to-webp')">
                        <i class="fas fa-file-image"></i>
                        <span>Convert to JPG</span>
                    </a>
                    <a href="#" class="quick-action" onclick="showPage('add-watermark')">
                        <i class="fas fa-copyright"></i>
                        <span>Watermark Image</span>
                    </a>
                </div>

                <!-- Tools Grid -->
                <h2 style="margin: 2rem 0 1rem; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-cubes" style="color: var(--primary);"></i>
                    Popular Tools
                </h2>
                <div class="controls-grid">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-arrows-alt"></i>
                            <span>Resize Image</span>
                        </div>
                        <p style="color: var(--gray); margin-bottom: 1rem;">Resize images by percentage or exact dimensions</p>
                        <button class="btn btn-primary" onclick="showPage('resize-percentage')">
                            <i class="fas fa-arrow-right"></i> Open Tool
                        </button>
                    </div>
                    
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-compress"></i>
                            <span>Compress Image</span>
                        </div>
                        <p style="color: var(--gray); margin-bottom: 1rem;">Reduce file size while maintaining quality</p>
                        <button class="btn btn-primary" onclick="showPage('compress-image')">
                            <i class="fas fa-arrow-right"></i> Open Tool
                        </button>
                    </div>
                    
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-crop"></i>
                            <span>Crop Image</span>
                        </div>
                        <p style="color: var(--gray); margin-bottom: 1rem;">Crop images to exact dimensions</p>
                        <button class="btn btn-primary" onclick="showPage('crop-image')">
                            <i class="fas fa-arrow-right"></i> Open Tool
                        </button>
                    </div>
                    
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-magic"></i>
                            <span>Social Media Resize</span>
                        </div>
                        <p style="color: var(--gray); margin-bottom: 1rem;">Perfect sizes for all social platforms</p>
                        <button class="btn btn-primary" onclick="showPage('social-media-resizer')">
                            <i class="fas fa-arrow-right"></i> Open Tool
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- RESIZE PERCENTAGE PAGE -->
        <div data-page="resize-percentage">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Resize Image by Percentage</h1>
                    <p class="tool-description">Scale your images up or down by percentage. Perfect for batch resizing.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="percentageUpload" onclick="document.getElementById('percentageFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Drop your images here</h3>
                    <p class="upload-subtitle">or click to browse (JPG, PNG, WebP)</p>
                    <input type="file" id="percentageFileInput" accept="image/*" style="display: none;" onchange="handlePercentageUpload(this.files)">
                </div>

                <!-- Preview Section -->
                <div class="preview-section" id="percentagePreview" style="display: none;">
                    <div class="preview-card">
                        <h4><i class="fas fa-original"></i> Original</h4>
                        <img id="originalPercentageImage" class="preview-image" src="" alt="Original">
                        <div class="preview-info" id="originalPercentageInfo"></div>
                    </div>
                    <div class="preview-card">
                        <h4><i class="fas fa-edit"></i> Resized</h4>
                        <img id="resizedPercentageImage" class="preview-image" src="" alt="Resized">
                        <div class="preview-info" id="resizedPercentageInfo"></div>
                    </div>
                </div>

                <!-- Controls -->
                <div class="controls-grid" id="percentageControls" style="display: none;">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-percent"></i>
                            <span>Resize Percentage</span>
                        </div>
                        <div class="input-group">
                            <label>Percentage</label>
                            <input type="range" id="percentageSlider" class="input-field" min="1" max="200" value="100" oninput="updatePercentagePreview()">
                            <input type="number" id="percentageValue" class="input-field" min="1" max="200" value="100" style="width: 80px;" onchange="updatePercentageSlider()">
                        </div>
                        <div style="margin-top: 1rem;">
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="keepAspectPercentage" checked onchange="updatePercentagePreview()">
                                <span>Keep aspect ratio</span>
                            </label>
                        </div>
                        <div style="margin-top: 1rem; display: flex; gap: 1rem;">
                            <div>
                                <label style="font-size: 0.9rem; color: var(--gray);">Width (px)</label>
                                <input type="number" id="percentageWidth" class="input-field" readonly style="background: var(--gray-light);">
                            </div>
                            <div>
                                <label style="font-size: 0.9rem; color: var(--gray);">Height (px)</label>
                                <input type="number" id="percentageHeight" class="input-field" readonly style="background: var(--gray-light);">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Progress Bar -->
                <div class="progress-container" id="percentageProgress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="percentageProgressFill"></div>
                    </div>
                    <div class="progress-stats">
                        <span id="percentageProgressText">0% Complete</span>
                        <span id="percentageProgressTime">Processing...</span>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="btn-group" id="percentageActions" style="display: none;">
                    <button class="btn btn-primary" onclick="processPercentageResize()">
                        <i class="fas fa-magic"></i> Resize Image
                    </button>
                    <button class="btn btn-success" id="downloadPercentageBtn" onclick="downloadPercentageImage()" style="display: none;">
                        <i class="fas fa-download"></i> Download Resized Image
                    </button>
                    <button class="btn btn-outline" onclick="resetPercentageTool()">
                        <i class="fas fa-redo"></i> Back
                    </button>
                </div>
            </div>
        </div>

        <!-- ADVANCED RESIZE + ASPECT RATIO PAGE -->
        <div data-page="resize-aspect-ratio">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Advanced Resize + Aspect Ratios</h1>
                    <p class="tool-description">Resize images with perfect aspect ratios for any platform.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="aspectUpload" onclick="document.getElementById('aspectFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload your image</h3>
                    <p class="upload-subtitle">Click to browse or drag & drop</p>
                    <input type="file" id="aspectFileInput" accept="image/*" style="display: none;" onchange="handleAspectUpload(this.files)">
                </div>

                <!-- Preview with Grid Overlay -->
                <div class="preview-section" id="aspectPreview" style="display: none;">
                    <div class="preview-card">
                        <h4><i class="fas fa-original"></i> Original with Grid Overlay</h4>
                        <div style="position: relative;">
                            <img id="originalAspectImage" class="preview-image" src="" alt="Original">
                            <canvas id="gridOverlay" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;"></canvas>
                        </div>
                    </div>
                    <div class="preview-card">
                        <h4><i class="fas fa-edit"></i> Cropped Preview</h4>
                        <img id="resizedAspectImage" class="preview-image" src="" alt="Cropped">
                    </div>
                </div>

                <!-- Aspect Ratio Presets -->
                <div class="control-group" style="margin-top: 1.5rem;" id="aspectControls" style="display: none;">
                    <div class="control-label">
                        <i class="fas fa-arrows-alt"></i>
                        <span>Aspect Ratio Presets</span>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
                        <select id="aspectRatioCategory" class="input-field" style="max-width: 200px;" onchange="loadAspectPresets()">
                            <option value="standard">Standard Ratios</option>
                            <option value="social">Social Media</option>
                            <option value="print">Print Sizes</option>
                            <option value="paper">Paper Sizes</option>
                        </select>
                    </div>

                    <div class="aspect-grid" id="aspectPresetGrid">
                        <!-- Aspect presets will be loaded here -->
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1.5rem;">
                        <div class="input-group">
                            <label>Width (px)</label>
                            <input type="number" id="aspectWidth" class="input-field" placeholder="Width" onchange="updateAspectFromDimensions()">
                        </div>
                        <div class="input-group">
                            <label>Height (px)</label>
                            <input type="number" id="aspectHeight" class="input-field" placeholder="Height" onchange="updateAspectFromDimensions()">
                        </div>
                    </div>

                    <div style="margin-top: 1.5rem;">
                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="fitMode" checked>
                            <span>Fit (preserve full image)</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.5rem;">
                            <input type="checkbox" id="fillMode">
                            <span>Fill (cover entire area)</span>
                        </label>
                    </div>

                    <button class="btn btn-primary" style="margin-top: 1.5rem; width: 100%;" onclick="processAspectResize()">
                        <i class="fas fa-crop"></i> Apply Crop & Resize
                    </button>
                </div>

                <!-- Download Button -->
                <div class="btn-group" id="aspectDownloadBtn" style="display: none; margin-top: 1.5rem;">
                    <button class="btn btn-success" onclick="downloadAspectImage()">
                        <i class="fas fa-download"></i> Download Processed Image
                    </button>
                    <button class="btn btn-outline" onclick="resetAspectTool()">
                        <i class="fas fa-redo"></i> Process Another
                    </button>
                </div>
            </div>
        </div>

        <!-- COMPRESS IMAGE PAGE -->
        <div data-page="compress-image">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Compress Image</h1>
                    <p class="tool-description">Reduce file size while maintaining visual quality.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="compressUpload" onclick="document.getElementById('compressFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload image to compress</h3>
                    <p class="upload-subtitle">JPG, PNG, WebP supported</p>
                    <input type="file" id="compressFileInput" accept="image/*" style="display: none;" onchange="handleCompressUpload(this.files)">
                </div>

                <!-- Preview -->
                <div class="preview-section" id="compressPreview" style="display: none;">
                    <div class="preview-card">
                        <h4><i class="fas fa-original"></i> Original</h4>
                        <img id="originalCompressImage" class="preview-image" src="" alt="Original">
                        <div class="preview-info" id="originalCompressInfo"></div>
                    </div>
                    <div class="preview-card">
                        <h4><i class="fas fa-compress"></i> Compressed</h4>
                        <img id="compressedImage" class="preview-image" src="" alt="Compressed">
                        <div class="preview-info" id="compressedInfo"></div>
                    </div>
                </div>

                <!-- Compression Options -->
                <div class="controls-grid" id="compressControls" style="display: none;">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-sliders-h"></i>
                            <span>Compression Method</span>
                        </div>
                        
                        <div style="margin-bottom: 1.5rem;">
                            <label style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                <input type="radio" name="compressMethod" value="auto" checked onchange="toggleCompressMethod()">
                                <span>Auto (Preserve quality)</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="radio" name="compressMethod" value="manual" onchange="toggleCompressMethod()">
                                <span>Manual (Target file size)</span>
                            </label>
                        </div>

                        <div id="autoCompressControls">
                            <label>Quality</label>
                            <input type="range" id="compressQuality" class="input-field" min="1" max="100" value="80" oninput="updateCompressQualityLabel()">
                            <span id="compressQualityValue" style="margin-left: 0.5rem;">80%</span>
                        </div>

                        <div id="manualCompressControls" style="display: none;">
                            <label>Target File Size</label>
                            <div style="display: flex; gap: 0.5rem;">
                                <input type="range" id="targetSizeSlider" class="input-field" min="10" max="10240" value="500" oninput="updateTargetSizeLabel()">
                                <input type="number" id="targetSizeValue" class="input-field" min="10" max="10240" value="500" style="width: 100px;" onchange="updateTargetSizeSlider()">
                            </div>
                            <span id="targetSizeLabel" style="display: block; margin-top: 0.5rem;">500 KB</span>
                            
                            <div style="margin-top: 1rem;">
                                <label>Resolution</label>
                                <select id="targetResolution" class="input-field">
                                    <option value="original">No change</option>
                                    <option value="custom">Custom resolution</option>
                                </select>
                            </div>
                            
                            <div id="customResolutionControls" style="display: none; margin-top: 1rem;">
                                <div style="display: flex; gap: 0.5rem;">
                                    <input type="number" id="customWidth" class="input-field" placeholder="Width">
                                    <span style="align-self: center;">Ã—</span>
                                    <input type="number" id="customHeight" class="input-field" placeholder="Height">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="btn-group" id="compressActions" style="display: none;">
                    <button class="btn btn-primary" onclick="processCompression()">
                        <i class="fas fa-compress"></i> Compress Image
                    </button>
                    <button class="btn btn-success" id="downloadCompressedBtn" onclick="downloadCompressedImage()" style="display: none;">
                        <i class="fas fa-download"></i> Download Compressed Image
                    </button>
                    <button class="btn btn-outline" onclick="resetCompressTool()">
                        <i class="fas fa-redo"></i> Back
                    </button>
                </div>

                <!-- Progress -->
                <div class="progress-container" id="compressProgress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="compressProgressFill"></div>
                    </div>
                    <div class="progress-stats">
                        <span id="compressProgressText">0% Complete</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- MIRROR IMAGE PAGE -->
        <div data-page="mirror-image">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Mirror Image</h1>
                    <p class="tool-description">Flip images horizontally or vertically.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="mirrorUpload" onclick="document.getElementById('mirrorFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload image to mirror</h3>
                    <p class="upload-subtitle">Click to browse or drag & drop</p>
                    <input type="file" id="mirrorFileInput" accept="image/*" style="display: none;" onchange="handleMirrorUpload(this.files)">
                </div>

                <!-- Preview -->
                <div class="preview-section" id="mirrorPreview" style="display: none;">
                    <div class="preview-card">
                        <h4><i class="fas fa-original"></i> Original</h4>
                        <img id="originalMirrorImage" class="preview-image" src="" alt="Original">
                    </div>
                    <div class="preview-card">
                        <h4><i class="fas fa-edit"></i> Mirrored</h4>
                        <img id="mirroredImage" class="preview-image" src="" alt="Mirrored">
                    </div>
                </div>

                <!-- Controls -->
                <div class="btn-group" id="mirrorControls" style="display: none; justify-content: center;">
                    <button class="btn btn-outline" onclick="applyMirror('horizontal')">
                        <i class="fas fa-arrows-alt-h"></i> Horizontal Mirror
                    </button>
                    <button class="btn btn-outline" onclick="applyMirror('vertical')">
                        <i class="fas fa-arrows-alt-v"></i> Vertical Mirror
                    </button>
                </div>

                <!-- Download Button -->
                <div class="btn-group" id="mirrorDownloadBtn" style="display: none;">
                    <button class="btn btn-success" onclick="downloadMirroredImage()">
                        <i class="fas fa-download"></i> Download Mirrored Image
                    </button>
                    <button class="btn btn-outline" onclick="resetMirrorTool()">
                        <i class="fas fa-redo"></i> Process Another
                    </button>
                </div>
            </div>
        </div>

        <!-- PIXELATE IMAGE PAGE -->
        <div data-page="pixelate-image">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Pixelate Image</h1>
                    <p class="tool-description">Add pixelation effects to your images.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="pixelateUpload" onclick="document.getElementById('pixelateFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload image to pixelate</h3>
                    <p class="upload-subtitle">Click to browse or drag & drop</p>
                    <input type="file" id="pixelateFileInput" accept="image/*" style="display: none;" onchange="handlePixelateUpload(this.files)">
                </div>

                <!-- Preview -->
                <div class="preview-section" id="pixelatePreview" style="display: none;">
                    <div class="preview-card">
                        <h4><i class="fas fa-original"></i> Original</h4>
                        <img id="originalPixelateImage" class="preview-image" src="" alt="Original">
                    </div>
                    <div class="preview-card">
                        <h4><i class="fas fa-edit"></i> Pixelated</h4>
                        <img id="pixelatedImage" class="preview-image" src="" alt="Pixelated">
                    </div>
                </div>

                <!-- Controls -->
                <div class="controls-grid" id="pixelateControls" style="display: none;">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-th"></i>
                            <span>Pixelation Level</span>
                        </div>
                        
                        <div style="margin-bottom: 1.5rem;">
                            <input type="range" id="pixelateLevel" class="input-field" min="2" max="50" value="10" oninput="updatePixelatePreview()">
                            <span id="pixelateLevelValue" style="margin-left: 0.5rem;">10px</span>
                        </div>

                        <div>
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="blackWhiteMode" onchange="updatePixelatePreview()">
                                <span>Black & White Mode</span>
                            </label>
                        </div>

                        <button class="btn btn-primary" style="margin-top: 1.5rem; width: 100%;" onclick="applyPixelation()">
                            <i class="fas fa-magic"></i> Apply Effect
                        </button>
                    </div>
                </div>

                <!-- Download Button -->
                <div class="btn-group" id="pixelateDownloadBtn" style="display: none;">
                    <button class="btn btn-success" onclick="downloadPixelatedImage()">
                        <i class="fas fa-download"></i> Download Pixelated Image
                    </button>
                    <button class="btn btn-outline" onclick="resetPixelateTool()">
                        <i class="fas fa-redo"></i> Process Another
                    </button>
                </div>
            </div>
        </div>

        <!-- ROTATE IMAGE PAGE -->
        <div data-page="rotate-image">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Rotate Image</h1>
                    <p class="tool-description">Rotate images by 90Â° increments or custom angles.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="rotateUpload" onclick="document.getElementById('rotateFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload image to rotate</h3>
                    <p class="upload-subtitle">Click to browse or drag & drop</p>
                    <input type="file" id="rotateFileInput" accept="image/*" style="display: none;" onchange="handleRotateUpload(this.files)">
                </div>

                <!-- Preview -->
                <div class="preview-section" id="rotatePreview" style="display: none;">
                    <div class="preview-card">
                        <h4><i class="fas fa-original"></i> Original</h4>
                        <img id="originalRotateImage" class="preview-image" src="" alt="Original">
                    </div>
                    <div class="preview-card">
                        <h4><i class="fas fa-edit"></i> Rotated</h4>
                        <img id="rotatedImage" class="preview-image" src="" alt="Rotated">
                    </div>
                </div>

                <!-- Controls -->
                <div class="controls-grid" id="rotateControls" style="display: none;">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-undo-alt"></i>
                            <span>Rotation Options</span>
                        </div>
                        
                        <div style="display: flex; gap: 0.5rem; margin-bottom: 1.5rem;">
                            <button class="btn btn-outline" onclick="rotateImage(-90)">
                                <i class="fas fa-undo"></i> Rotate Left 90Â°
                            </button>
                            <button class="btn btn-outline" onclick="rotateImage(90)">
                                <i class="fas fa-redo"></i> Rotate Right 90Â°
                            </button>
                        </div>

                        <div style="margin-top: 1rem;">
                            <label>Custom Angle</label>
                            <div style="display: flex; gap: 0.5rem;">
                                <input type="range" id="customAngle" class="input-field" min="0" max="360" value="0" oninput="updateCustomAngleLabel()">
                                <input type="number" id="angleValue" class="input-field" min="0" max="360" value="0" style="width: 80px;" onchange="updateAngleSlider()">
                            </div>
                            <span id="angleLabel">0Â°</span>
                            
                            <button class="btn btn-primary" style="margin-top: 1rem; width: 100%;" onclick="applyCustomRotation()">
                                <i class="fas fa-sync"></i> Apply Rotation
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Download Button -->
                <div class="btn-group" id="rotateDownloadBtn" style="display: none;">
                    <button class="btn btn-success" onclick="downloadRotatedImage()">
                        <i class="fas fa-download"></i> Download Rotated Image
                    </button>
                    <button class="btn btn-outline" onclick="resetRotateTool()">
                        <i class="fas fa-redo"></i> Process Another
                    </button>
                </div>
            </div>
        </div>

        <!-- SOCIAL MEDIA RESIZER PAGE -->
        <div data-page="social-media-resizer">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Social Media Image Resizer</h1>
                    <p class="tool-description">Perfect image sizes for all social platforms.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="socialUpload" onclick="document.getElementById('socialFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload image for social media</h3>
                    <p class="upload-subtitle">Click to browse or drag & drop</p>
                    <input type="file" id="socialFileInput" accept="image/*" style="display: none;" onchange="handleSocialUpload(this.files)">
                </div>

                <!-- Preview -->
                <div class="preview-section" id="socialPreview" style="display: none;">
                    <div class="preview-card">
                        <h4><i class="fas fa-original"></i> Original</h4>
                        <img id="originalSocialImage" class="preview-image" src="" alt="Original">
                        <div class="preview-info" id="originalSocialInfo"></div>
                    </div>
                    <div class="preview-card">
                        <h4><i class="fas fa-edit"></i> Resized for Social</h4>
                        <img id="socialResizedImage" class="preview-image" src="" alt="Resized">
                        <div class="preview-info" id="socialResizedInfo"></div>
                    </div>
                </div>

                <!-- Social Media Presets -->
                <div class="controls-grid" id="socialControls" style="display: none;">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-share-alt"></i>
                            <span>Platform & Format</span>
                        </div>
                        
                        <select id="socialPlatform" class="input-field" style="margin-bottom: 1rem;" onchange="updateSocialPreset()">
                            <optgroup label="Instagram">
                                <option value="ig-post">Instagram Post (1:1) - 1080Ã—1080</option>
                                <option value="ig-portrait">Instagram Portrait (4:5) - 1080Ã—1350</option>
                                <option value="ig-landscape">Instagram Landscape (1.91:1) - 1080Ã—566</option>
                                <option value="ig-story">Instagram Story (9:16) - 1080Ã—1920</option>
                                <option value="ig-reels">Instagram Reels (9:16) - 1080Ã—1920</option>
                                <option value="ig-profile">Instagram Profile (1:1) - 320Ã—320</option>
                            </optgroup>
                            <optgroup label="Facebook">
                                <option value="fb-post">Facebook Post (1.91:1) - 1200Ã—630</option>
                                <option value="fb-cover">Facebook Cover (16:9) - 820Ã—462</option>
                                <option value="fb-event">Facebook Event (1.91:1) - 1920Ã—1005</option>
                                <option value="fb-profile">Facebook Profile (1:1) - 180Ã—180</option>
                            </optgroup>
                            <optgroup label="Twitter">
                                <option value="tw-post">Twitter Post (16:9) - 1200Ã—675</option>
                                <option value="tw-header">Twitter Header (3:1) - 1500Ã—500</option>
                                <option value="tw-profile">Twitter Profile (1:1) - 400Ã—400</option>
                            </optgroup>
                            <optgroup label="LinkedIn">
                                <option value="li-post">LinkedIn Post (1.91:1) - 1200Ã—627</option>
                                <option value="li-cover">LinkedIn Background (4:1) - 1584Ã—396</option>
                                <option value="li-profile">LinkedIn Profile (1:1) - 400Ã—400</option>
                            </optgroup>
                            <optgroup label="Pinterest">
                                <option value="pin-pin">Pinterest Pin (2:3) - 1000Ã—1500</option>
                                <option value="pin-profile">Pinterest Profile (1:1) - 165Ã—165</option>
                            </optgroup>
                            <optgroup label="YouTube">
                                <option value="yt-thumbnail">YouTube Thumbnail (16:9) - 1280Ã—720</option>
                                <option value="yt-cover">YouTube Channel Art (16:9) - 2560Ã—1440</option>
                                <option value="yt-profile">YouTube Profile (1:1) - 800Ã—800</option>
                            </optgroup>
                        </select>

                        <div style="margin-bottom: 1rem;">
                            <label>Resize Type</label>
                            <select id="resizeType" class="input-field">
                                <option value="fit">FIT (Preserve full image)</option>
                                <option value="fill">FILL (Cover area, may crop)</option>
                                <option value="stretch">STRETCH (Distort to fit)</option>
                            </select>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>Background Fill</label>
                            <select id="backgroundType" class="input-field">
                                <option value="none">No Background</option>
                                <option value="color">Solid Color</option>
                                <option value="blur">Blurred Background</option>
                            </select>
                        </div>

                        <div id="bgColorPicker" style="display: none; margin-bottom: 1rem;">
                            <input type="color" id="bgColor" value="#ffffff">
                        </div>

                        <div style="display: flex; gap: 0.5rem;">
                            <input type="number" id="socialWidth" class="input-field" placeholder="Width" readonly>
                            <span>Ã—</span>
                            <input type="number" id="socialHeight" class="input-field" placeholder="Height" readonly>
                        </div>

                        <button class="btn btn-primary" style="margin-top: 1.5rem; width: 100%;" onclick="processSocialResize()">
                            <i class="fas fa-magic"></i> Resize for Social Media
                        </button>
                    </div>
                </div>

                <!-- Download Button -->
                <div class="btn-group" id="socialDownloadBtn" style="display: none;">
                    <button class="btn btn-success" onclick="downloadSocialImage()">
                        <i class="fas fa-download"></i> Download Social Media Image
                    </button>
                    <button class="btn btn-outline" onclick="resetSocialTool()">
                        <i class="fas fa-redo"></i> Process Another
                    </button>
                </div>
            </div>
        </div>

        <!-- RESIZE TO KILOBYTES PAGE -->
        <div data-page="resize-to-kb">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Resize Image to Exact File Size</h1>
                    <p class="tool-description">Compress images to specific kilobyte or megabyte targets.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="kbUpload" onclick="document.getElementById('kbFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload image to resize</h3>
                    <p class="upload-subtitle">Target specific file sizes</p>
                    <input type="file" id="kbFileInput" accept="image/*" style="display: none;" onchange="handleKBUpload(this.files)">
                </div>

                <!-- Preview -->
                <div class="preview-section" id="kbPreview" style="display: none;">
                    <div class="preview-card">
                        <h4><i class="fas fa-original"></i> Original</h4>
                        <img id="originalKBImage" class="preview-image" src="" alt="Original">
                        <div class="preview-info" id="originalKBInfo"></div>
                    </div>
                    <div class="preview-card">
                        <h4><i class="fas fa-file"></i> Resized</h4>
                        <img id="resizedKBImage" class="preview-image" src="" alt="Resized">
                        <div class="preview-info" id="resizedKBInfo"></div>
                    </div>
                </div>

                <!-- Controls -->
                <div class="controls-grid" id="kbControls" style="display: none;">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-file"></i>
                            <span>Target File Size</span>
                        </div>
                        
                        <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                            <select id="kbPreset" class="input-field" onchange="updateKBPreset()">
                                <option value="10">10 KB</option>
                                <option value="20">20 KB</option>
                                <option value="50">50 KB</option>
                                <option value="100">100 KB</option>
                                <option value="200">200 KB</option>
                                <option value="500">500 KB</option>
                                <option value="1024">1 MB</option>
                                <option value="2048">2 MB</option>
                                <option value="5120">5 MB</option>
                                <option value="10240">10 MB</option>
                                <option value="custom">Custom Size</option>
                            </select>
                        </div>

                        <div id="customKBSize" style="display: none; margin-bottom: 1rem;">
                            <div style="display: flex; gap: 0.5rem;">
                                <input type="number" id="customKBValue" class="input-field" placeholder="Enter size" min="1">
                                <select id="customKBUnit" class="input-field" style="width: 100px;">
                                    <option value="KB">KB</option>
                                    <option value="MB">MB</option>
                                </select>
                            </div>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>Resolution</label>
                            <select id="kbResolution" class="input-field" onchange="toggleKBResolution()">
                                <option value="original">No change (keep dimensions)</option>
                                <option value="custom">Custom resolution</option>
                            </select>
                        </div>

                        <div id="kbCustomResolution" style="display: none; margin-bottom: 1rem;">
                            <div style="display: flex; gap: 0.5rem;">
                                <input type="number" id="kbWidth" class="input-field" placeholder="Width">
                                <span>Ã—</span>
                                <input type="number" id="kbHeight" class="input-field" placeholder="Height">
                            </div>
                            <label style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.5rem;">
                                <input type="checkbox" id="kbKeepAspect" checked>
                                <span>Keep aspect ratio</span>
                            </label>
                        </div>

                        <button class="btn btn-primary" style="width: 100%;" onclick="processKBResize()">
                            <i class="fas fa-file"></i> Resize to Target Size
                        </button>
                    </div>
                </div>

                <!-- Download Button -->
                <div class="btn-group" id="kbDownloadBtn" style="display: none;">
                    <button class="btn btn-success" onclick="downloadKBImage()">
                        <i class="fas fa-download"></i> Download Resized Image
                    </button>
                    <button class="btn btn-outline" onclick="resetKBTool()">
                        <i class="fas fa-redo"></i> Process Another
                    </button>
                </div>

                <!-- Progress -->
                <div class="progress-container" id="kbProgress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="kbProgressFill"></div>
                    </div>
                    <div class="progress-stats">
                        <span id="kbProgressText">Optimizing to target size...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- PRINT RESIZE PAGE -->
        <div data-page="print-resize">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Print Resize</h1>
                    <p class="tool-description">Resize images for printing with exact dimensions and DPI.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="printUpload" onclick="document.getElementById('printFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload image for print</h3>
                    <p class="upload-subtitle">Optimize for physical printing</p>
                    <input type="file" id="printFileInput" accept="image/*" style="display: none;" onchange="handlePrintUpload(this.files)">
                </div>

                <!-- Preview -->
                <div class="preview-section" id="printPreview" style="display: none;">
                    <div class="preview-card">
                        <h4><i class="fas fa-original"></i> Original</h4>
                        <img id="originalPrintImage" class="preview-image" src="" alt="Original">
                        <div class="preview-info" id="originalPrintInfo"></div>
                    </div>
                    <div class="preview-card">
                        <h4><i class="fas fa-print"></i> Print Ready</h4>
                        <img id="printReadyImage" class="preview-image" src="" alt="Print Ready">
                        <div class="preview-info" id="printReadyInfo"></div>
                    </div>
                </div>

                <!-- Print Controls -->
                <div class="controls-grid" id="printControls" style="display: none;">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-ruler"></i>
                            <span>Print Dimensions</span>
                        </div>
                        
                        <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                            <select id="printUnit" class="input-field" style="width: 100px;" onchange="updatePrintUnit()">
                                <option value="inch">Inches</option>
                                <option value="cm">Centimeters</option>
                                <option value="mm">Millimeters</option>
                            </select>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>Paper Size Presets</label>
                            <select id="printPreset" class="input-field" onchange="applyPrintPreset()">
                                <optgroup label="Standard Sizes">
                                    <option value="letter">Letter (8.5Ã—11")</option>
                                    <option value="legal">Legal (8.5Ã—14")</option>
                                    <option value="tabloid">Tabloid (11Ã—17")</option>
                                </optgroup>
                                <optgroup label="Photo Sizes">
                                    <option value="4x6">4Ã—6"</option>
                                    <option value="5x7">5Ã—7"</option>
                                    <option value="8x10">8Ã—10"</option>
                                    <option value="11x14">11Ã—14"</option>
                                    <option value="12x16">12Ã—16"</option>
                                    <option value="16x20">16Ã—20"</option>
                                    <option value="20x24">20Ã—24"</option>
                                    <option value="20x30">20Ã—30"</option>
                                    <option value="24x36">24Ã—36"</option>
                                </optgroup>
                                <optgroup label="A Series">
                                    <option value="a0">A0 (33.1Ã—46.8")</option>
                                    <option value="a1">A1 (23.4Ã—33.1")</option>
                                    <option value="a2">A2 (16.5Ã—23.4")</option>
                                    <option value="a3">A3 (11.7Ã—16.5")</option>
                                    <option value="a4">A4 (8.3Ã—11.7")</option>
                                    <option value="a5">A5 (5.8Ã—8.3")</option>
                                    <option value="a6">A6 (4.1Ã—5.8")</option>
                                </optgroup>
                                <option value="custom">Custom Size</option>
                            </select>
                        </div>

                        <div id="customPrintSize" style="display: none; margin-bottom: 1rem;">
                            <div style="display: flex; gap: 0.5rem;">
                                <input type="number" id="printWidth" class="input-field" placeholder="Width" step="0.01">
                                <span>Ã—</span>
                                <input type="number" id="printHeight" class="input-field" placeholder="Height" step="0.01">
                            </div>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>DPI (Resolution)</label>
                            <select id="printDPI" class="input-field" onchange="updatePrintDPI()">
                                <option value="300">300 DPI (High quality)</option>
                                <option value="240">240 DPI (Good quality)</option>
                                <option value="200">200 DPI (Standard)</option>
                                <option value="150">150 DPI (Draft)</option>
                                <option value="96">96 DPI (Screen)</option>
                                <option value="72">72 DPI (Web)</option>
                            </select>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>Output Format</label>
                            <select id="printFormat" class="input-field">
                                <option value="jpg">JPEG</option>
                                <option value="png">PNG</option>
                                <option value="webp">WebP</option>
                                <option value="pdf">PDF</option>
                            </select>
                        </div>

                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 1rem; border-radius: 12px; color: white;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span>Print Size:</span>
                                <span id="printSizeDisplay">0 Ã— 0 "</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span>Pixel Dimensions:</span>
                                <span id="pixelSizeDisplay">0 Ã— 0 px</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>File Size Estimate:</span>
                                <span id="fileSizeEstimate">0 MB</span>
                            </div>
                        </div>

                        <button class="btn btn-primary" style="margin-top: 1.5rem; width: 100%;" onclick="processPrintResize()">
                            <i class="fas fa-print"></i> Prepare for Printing
                        </button>
                    </div>
                </div>

                <!-- Download Button -->
                <div class="btn-group" id="printDownloadBtn" style="display: none;">
                    <button class="btn btn-success" onclick="downloadPrintImage()">
                        <i class="fas fa-download"></i> Download Print-Ready Image
                    </button>
                    <button class="btn btn-outline" onclick="resetPrintTool()">
                        <i class="fas fa-redo"></i> Process Another
                    </button>
                </div>
            </div>
        </div>

        <!-- RESIZE WITH DIMENSIONS & DPI PAGE -->
        <div data-page="resize-dimensions">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Resize with DPI</h1>
                    <p class="tool-description">Professional image resizing with exact dimensions and DPI control.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="dpiUpload" onclick="document.getElementById('dpiFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload image to resize</h3>
                    <p class="upload-subtitle">Control dimensions, DPI, and format</p>
                    <input type="file" id="dpiFileInput" accept="image/*" style="display: none;" onchange="handleDPIUpload(this.files)">
                </div>

                <!-- Preview -->
                <div class="preview-section" id="dpiPreview" style="display: none;">
                    <div class="preview-card">
                        <h4><i class="fas fa-original"></i> Original</h4>
                        <img id="originalDPIImage" class="preview-image" src="" alt="Original">
                        <div class="preview-info" id="originalDPIInfo"></div>
                    </div>
                    <div class="preview-card">
                        <h4><i class="fas fa-edit"></i> Resized</h4>
                        <img id="resizedDPIImage" class="preview-image" src="" alt="Resized">
                        <div class="preview-info" id="resizedDPIInfo"></div>
                    </div>
                </div>

                <!-- DPI Controls -->
                <div class="controls-grid" id="dpiControls" style="display: none;">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-ruler"></i>
                            <span>Dimensions & DPI</span>
                        </div>
                        
                        <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                            <select id="dpiUnit" class="input-field" onchange="updateDPIUnit()">
                                <option value="px">Pixels</option>
                                <option value="inch">Inches</option>
                                <option value="cm">Centimeters</option>
                                <option value="mm">Millimeters</option>
                            </select>
                        </div>

                        <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                            <div style="flex: 1;">
                                <label>Width</label>
                                <input type="number" id="dpiWidth" class="input-field" onchange="updateDPIFromDimensions()">
                            </div>
                            <div style="flex: 1;">
                                <label>Height</label>
                                <input type="number" id="dpiHeight" class="input-field" onchange="updateDPIFromDimensions()">
                            </div>
                        </div>

                        <label style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                            <input type="checkbox" id="dpiKeepAspect" checked onchange="updateDPIKeepAspect()">
                            <span>Keep aspect ratio</span>
                        </label>

                        <div style="margin-bottom: 1rem;">
                            <label>DPI</label>
                            <select id="dpiValue" class="input-field" onchange="updateDPICalculations()">
                                <option value="300">300 DPI (Print)</option>
                                <option value="240">240 DPI (Print)</option>
                                <option value="200">200 DPI (Print)</option>
                                <option value="96">96 DPI (Screen)</option>
                                <option value="72">72 DPI (Web)</option>
                                <option value="custom">Custom DPI</option>
                            </select>
                        </div>

                        <div id="customDPI" style="display: none; margin-bottom: 1rem;">
                            <input type="number" id="customDPIValue" class="input-field" placeholder="Enter DPI" min="1" max="1200" onchange="updateDPICalculations()">
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>Output Format</label>
                            <select id="dpiFormat" class="input-field">
                                <option value="jpg">JPEG</option>
                                <option value="png">PNG</option>
                                <option value="webp">WebP</option>
                                <option value="pdf">PDF</option>
                                <option value="heic">HEIC</option>
                            </select>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>Quality</label>
                            <input type="range" id="dpiQuality" class="input-field" min="1" max="100" value="90" oninput="updateDPIQualityLabel()">
                            <span id="dpiQualityValue" style="margin-left: 0.5rem;">90%</span>
                        </div>

                        <div class="dpi-calculator">
                            <h4 style="margin-bottom: 0.5rem;">DPI Calculator</h4>
                            <div id="dpiCalculation">
                                <div>Print Size: <span id="calcPrintSize">0 Ã— 0 in</span></div>
                                <div>Pixels: <span id="calcPixels">0 Ã— 0 px</span></div>
                                <div>Megapixels: <span id="calcMegapixels">0 MP</span></div>
                            </div>
                        </div>

                        <button class="btn btn-primary" style="margin-top: 1.5rem; width: 100%;" onclick="processDPIResize()">
                            <i class="fas fa-magic"></i> Resize Image
                        </button>
                    </div>
                </div>

                <!-- Download Button -->
                <div class="btn-group" id="dpiDownloadBtn" style="display: none;">
                    <button class="btn btn-success" onclick="downloadDPIImage()">
                        <i class="fas fa-download"></i> Download Resized Image
                    </button>
                    <button class="btn btn-outline" onclick="resetDPITool()">
                        <i class="fas fa-redo"></i> Process Another
                    </button>
                </div>
            </div>
        </div>

        <!-- DIMENSION CALCULATOR PAGE -->
        <div data-page="dimension-calculator">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Photo Dimension Calculator</h1>
                    <p class="tool-description">Convert between inches, centimeters, millimeters, and pixels.</p>
                </div>

                <div class="controls-grid">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-calculator"></i>
                            <span>Dimension Converter</span>
                        </div>

                        <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
                            <div style="flex: 1;">
                                <label>From Unit</label>
                                <select id="calcFromUnit" class="input-field" onchange="calculateDimensions()">
                                    <option value="px">Pixels (px)</option>
                                    <option value="in">Inches (in)</option>
                                    <option value="cm">Centimeters (cm)</option>
                                    <option value="mm">Millimeters (mm)</option>
                                </select>
                            </div>
                            <div style="flex: 1;">
                                <label>To Unit</label>
                                <select id="calcToUnit" class="input-field" onchange="calculateDimensions()">
                                    <option value="px">Pixels (px)</option>
                                    <option value="in">Inches (in)</option>
                                    <option value="cm">Centimeters (cm)</option>
                                    <option value="mm">Millimeters (mm)</option>
                                </select>
                            </div>
                        </div>

                        <div style="display: flex; gap: 0.5rem; margin-bottom: 1.5rem;">
                            <div style="flex: 1;">
                                <label>Width</label>
                                <input type="number" id="calcWidth" class="input-field" value="1920" oninput="calculateDimensions()">
                            </div>
                            <div style="flex: 1;">
                                <label>Height</label>
                                <input type="number" id="calcHeight" class="input-field" value="1080" oninput="calculateDimensions()">
                            </div>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>DPI (for pixel conversion)</label>
                            <input type="number" id="calcDPI" class="input-field" value="96" min="1" max="1200" oninput="calculateDimensions()">
                        </div>

                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 1.5rem; border-radius: 12px; color: white;">
                            <h4 style="margin-bottom: 1rem;">Conversion Results</h4>
                            <div style="display: grid; gap: 0.75rem;">
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Width:</span>
                                    <span id="calcResultWidth">0 px</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Height:</span>
                                    <span id="calcResultHeight">0 px</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; padding-top: 0.5rem; border-top: 1px solid rgba(255,255,255,0.3);">
                                    <span>Aspect Ratio:</span>
                                    <span id="calcAspectRatio">16:9</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Megapixels:</span>
                                    <span id="calcMegapixelsResult">2.07 MP</span>
                                </div>
                            </div>
                        </div>

                        <div style="margin-top: 1.5rem; display: flex; gap: 0.5rem;">
                            <button class="btn btn-outline" onclick="swapConversionUnits()">
                                <i class="fas fa-exchange-alt"></i> Swap Units
                            </button>
                            <button class="btn btn-outline" onclick="resetCalculator()">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CROP IMAGE PAGE -->
        <div data-page="crop-image">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Image Crop</h1>
                    <p class="tool-description">Crop images to exact coordinates.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="cropUpload" onclick="document.getElementById('cropFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload image to crop</h3>
                    <p class="upload-subtitle">Click to browse or drag & drop</p>
                    <input type="file" id="cropFileInput" accept="image/*" style="display: none;" onchange="handleCropUpload(this.files)">
                </div>

                <!-- Crop Preview -->
                <div class="preview-section" id="cropPreview" style="display: none;">
                    <div class="preview-card">
                        <h4><i class="fas fa-crop"></i> Crop Preview</h4>
                        <div style="position: relative;">
                            <img id="cropImage" class="preview-image" src="" alt="Crop" style="max-width: 100%;">
                            <div id="cropOverlay" style="position: absolute; border: 2px solid var(--primary); box-shadow: 0 0 0 9999px rgba(0,0,0,0.5); pointer-events: none;"></div>
                        </div>
                    </div>
                    <div class="preview-card">
                        <h4><i class="fas fa-edit"></i> Cropped Result</h4>
                        <img id="croppedImage" class="preview-image" src="" alt="Cropped">
                    </div>
                </div>

                <!-- Crop Controls -->
                <div class="controls-grid" id="cropControls" style="display: none;">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-crop"></i>
                            <span>Crop Coordinates</span>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div>
                                <label>X Position</label>
                                <input type="number" id="cropX" class="input-field" value="0" min="0" onchange="updateCropPreview()">
                            </div>
                            <div>
                                <label>Y Position</label>
                                <input type="number" id="cropY" class="input-field" value="0" min="0" onchange="updateCropPreview()">
                            </div>
                            <div>
                                <label>Width</label>
                                <input type="number" id="cropWidth" class="input-field" value="500" min="1" onchange="updateCropPreview()">
                            </div>
                            <div>
                                <label>Height</label>
                                <input type="number" id="cropHeight" class="input-field" value="500" min="1" onchange="updateCropPreview()">
                            </div>
                        </div>

                        <div style="margin-top: 1rem;">
                            <label>Aspect Ratio Presets</label>
                            <select id="cropAspect" class="input-field" onchange="applyCropAspect()">
                                <option value="custom">Custom</option>
                                <option value="1:1">Square (1:1)</option>
                                <option value="4:3">Standard (4:3)</option>
                                <option value="16:9">Widescreen (16:9)</option>
                                <option value="3:2">Photo (3:2)</option>
                                <option value="5:4">Medium (5:4)</option>
                                <option value="2:3">Portrait (2:3)</option>
                                <option value="9:16">Vertical (9:16)</option>
                            </select>
                        </div>

                        <button class="btn btn-primary" style="margin-top: 1.5rem; width: 100%;" onclick="processCrop()">
                            <i class="fas fa-crop"></i> Crop Image
                        </button>
                    </div>
                </div>

                <!-- Download Button -->
                <div class="btn-group" id="cropDownloadBtn" style="display: none;">
                    <button class="btn btn-success" onclick="downloadCroppedImage()">
                        <i class="fas fa-download"></i> Download Cropped Image
                    </button>
                    <button class="btn btn-outline" onclick="resetCropTool()">
                        <i class="fas fa-redo"></i> Process Another
                    </button>
                </div>
            </div>
        </div>

        <!-- OPTIMIZE IMAGE PAGE -->
        <div data-page="optimize-image">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Optimize Image</h1>
                    <p class="tool-description">Smart image optimization for web and mobile.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="optimizeUpload" onclick="document.getElementById('optimizeFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload image to optimize</h3>
                    <p class="upload-subtitle">Auto-optimize for web performance</p>
                    <input type="file" id="optimizeFileInput" accept="image/*" style="display: none;" onchange="handleOptimizeUpload(this.files)">
                </div>

                <!-- Preview -->
                <div class="preview-section" id="optimizePreview" style="display: none;">
                    <div class="preview-card">
                        <h4><i class="fas fa-original"></i> Original</h4>
                        <img id="originalOptimizeImage" class="preview-image" src="" alt="Original">
                        <div class="preview-info" id="originalOptimizeInfo"></div>
                    </div>
                    <div class="preview-card">
                        <h4><i class="fas fa-magic"></i> Optimized</h4>
                        <img id="optimizedImage" class="preview-image" src="" alt="Optimized">
                        <div class="preview-info" id="optimizedInfo"></div>
                    </div>
                </div>

                <!-- Optimize Controls -->
                <div class="controls-grid" id="optimizeControls" style="display: none;">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-sliders-h"></i>
                            <span>Optimization Settings</span>
                        </div>
                        
                        <div style="margin-bottom: 1.5rem;">
                            <label>Size Presets</label>
                            <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                                <button class="btn btn-outline" onclick="setOptimizePreset('small')">Small (640px)</button>
                                <button class="btn btn-outline" onclick="setOptimizePreset('medium')">Medium (800px)</button>
                                <button class="btn btn-outline" onclick="setOptimizePreset('large')">Large (1200px)</button>
                                <button class="btn btn-outline" onclick="setOptimizePreset('custom')">Custom</button>
                            </div>
                        </div>

                        <div id="optimizeCustomSize" style="display: none; margin-bottom: 1rem;">
                            <div style="display: flex; gap: 0.5rem;">
                                <input type="number" id="optimizeWidth" class="input-field" placeholder="Width" value="800">
                                <span>Ã—</span>
                                <input type="number" id="optimizeHeight" class="input-field" placeholder="Height" value="600">
                            </div>
                            <label style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.5rem;">
                                <input type="checkbox" id="optimizeKeepAspect" checked>
                                <span>Keep aspect ratio</span>
                            </label>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>Quality</label>
                            <input type="range" id="optimizeQuality" class="input-field" min="1" max="100" value="85" oninput="updateOptimizeQualityLabel()">
                            <div style="display: flex; justify-content: space-between;">
                                <span id="optimizeQualityValue">85%</span>
                                <span style="color: var(--gray);">Low â†’ Best</span>
                            </div>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>Output Format</label>
                            <select id="optimizeFormat" class="input-field">
                                <option value="auto">Auto (WebP if supported)</option>
                                <option value="jpg">JPEG</option>
                                <option value="png">PNG</option>
                                <option value="webp">WebP</option>
                            </select>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>Strip Metadata</label>
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="stripMetadata" checked>
                                <span>Remove EXIF data (better privacy, smaller file)</span>
                            </label>
                        </div>

                        <button class="btn btn-primary" style="width: 100%;" onclick="processOptimization()">
                            <i class="fas fa-magic"></i> Optimize Image
                        </button>
                    </div>
                </div>

                <!-- Download Button -->
                <div class="btn-group" id="optimizeDownloadBtn" style="display: none;">
                    <button class="btn btn-success" onclick="downloadOptimizedImage()">
                        <i class="fas fa-download"></i> Download Optimized Image
                    </button>
                    <button class="btn btn-outline" onclick="resetOptimizeTool()">
                        <i class="fas fa-redo"></i> Process Another
                    </button>
                </div>

                <!-- Progress -->
                <div class="progress-container" id="optimizeProgress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="optimizeProgressFill"></div>
                    </div>
                    <div class="progress-stats">
                        <span id="optimizeProgressText">Optimizing image...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- EXIF VIEWER PAGE -->
        <div data-page="exif-viewer">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">EXIF Metadata Viewer</h1>
                    <p class="tool-description">View and compare EXIF data from multiple images.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="exifUpload" onclick="document.getElementById('exifFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload images to view EXIF</h3>
                    <p class="upload-subtitle">Upload multiple images to compare metadata</p>
                    <input type="file" id="exifFileInput" accept="image/*" multiple style="display: none;" onchange="handleEXIFUpload(this.files)">
                </div>

                <!-- EXIF Display -->
                <div id="exifContainer" style="display: none;">
                    <div class="exif-container" id="exifGrid">
                        <!-- EXIF data will be displayed here -->
                    </div>
                </div>

                <!-- No Data Message -->
                <div id="noExifData" style="text-align: center; padding: 2rem; display: none;">
                    <i class="fas fa-info-circle" style="font-size: 3rem; color: var(--gray); margin-bottom: 1rem;"></i>
                    <h3 style="color: var(--gray);">No EXIF Data Found</h3>
                    <p style="color: var(--gray);">This image may have no metadata or was stripped.</p>
                </div>
            </div>
        </div>

        <!-- ADD WATERMARK PAGE -->
        <div data-page="add-watermark">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Add Watermark</h1>
                    <p class="tool-description">Protect your images with custom watermarks.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="watermarkUpload" onclick="document.getElementById('watermarkFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload image to watermark</h3>
                    <p class="upload-subtitle">Add text or image watermarks</p>
                    <input type="file" id="watermarkFileInput" accept="image/*" style="display: none;" onchange="handleWatermarkUpload(this.files)">
                </div>

                <!-- Preview -->
                <div class="preview-section" id="watermarkPreview" style="display: none;">
                    <div class="preview-card">
                        <h4><i class="fas fa-original"></i> Original</h4>
                        <img id="originalWatermarkImage" class="preview-image" src="" alt="Original">
                    </div>
                    <div class="preview-card">
                        <h4><i class="fas fa-copyright"></i> Watermarked</h4>
                        <img id="watermarkedImage" class="preview-image" src="" alt="Watermarked">
                    </div>
                </div>

                <!-- Watermark Controls -->
                <div class="controls-grid" id="watermarkControls" style="display: none;">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-copyright"></i>
                            <span>Watermark Settings</span>
                        </div>
                        
                        <div style="margin-bottom: 1rem;">
                            <label>Watermark Type</label>
                            <div style="display: flex; gap: 1rem;">
                                <label style="display: flex; align-items: center; gap: 0.5rem;">
                                    <input type="radio" name="watermarkType" value="text" checked onchange="toggleWatermarkType()">
                                    <span>Text</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 0.5rem;">
                                    <input type="radio" name="watermarkType" value="image" onchange="toggleWatermarkType()">
                                    <span>Image</span>
                                </label>
                            </div>
                        </div>

                        <div id="textWatermarkControls">
                            <div style="margin-bottom: 1rem;">
                                <label>Watermark Text</label>
                                <input type="text" id="watermarkText" class="input-field" value="Â© FastResizePro">
                            </div>
                            
                            <div style="margin-bottom: 1rem;">
                                <label>Font Size</label>
                                <input type="range" id="watermarkFontSize" class="input-field" min="12" max="72" value="32" oninput="updateWatermarkPreview()">
                                <span id="fontSizeValue">32px</span>
                            </div>
                            
                            <div style="margin-bottom: 1rem;">
                                <label>Color</label>
                                <input type="color" id="watermarkColor" value="#ffffff" onchange="updateWatermarkPreview()">
                            </div>
                            
                            <div style="margin-bottom: 1rem;">
                                <label>Opacity</label>
                                <input type="range" id="watermarkOpacity" class="input-field" min="0" max="100" value="70" oninput="updateWatermarkPreview()">
                                <span id="opacityValue">70%</span>
                            </div>
                        </div>

                        <div id="imageWatermarkControls" style="display: none;">
                            <div style="margin-bottom: 1rem;">
                                <label>Upload Watermark Image</label>
                                <input type="file" id="watermarkImageInput" accept="image/*" class="input-field" onchange="handleWatermarkImageUpload(this.files)">
                            </div>
                            <div id="watermarkImagePreview" style="display: none; margin-bottom: 1rem;">
                                <img id="watermarkImage" style="max-width: 100px; max-height: 100px; border: 2px solid var(--primary); border-radius: 8px;">
                            </div>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>Position</label>
                            <select id="watermarkPosition" class="input-field" onchange="updateWatermarkPreview()">
                                <option value="top-left">Top Left</option>
                                <option value="top-right">Top Right</option>
                                <option value="center" selected>Center</option>
                                <option value="bottom-left">Bottom Left</option>
                                <option value="bottom-right">Bottom Right</option>
                            </select>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>Margin</label>
                            <input type="range" id="watermarkMargin" class="input-field" min="0" max="100" value="20" oninput="updateWatermarkPreview()">
                            <span id="marginValue">20px</span>
                        </div>

                        <button class="btn btn-primary" style="width: 100%;" onclick="processWatermark()">
                            <i class="fas fa-copyright"></i> Apply Watermark
                        </button>
                    </div>
                </div>

                <!-- Download Button -->
                <div class="btn-group" id="watermarkDownloadBtn" style="display: none;">
                    <button class="btn btn-success" onclick="downloadWatermarkedImage()">
                        <i class="fas fa-download"></i> Download Watermarked Image
                    </button>
                    <button class="btn btn-outline" onclick="resetWatermarkTool()">
                        <i class="fas fa-redo"></i> Process Another
                    </button>
                </div>
            </div>
        </div>

        <!-- UPSCALE IMAGE PAGE -->
        <div data-page="upscale-image">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Image Upscaler</h1>
                    <p class="tool-description">Enlarge images with quality preservation.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="upscaleUpload" onclick="document.getElementById('upscaleFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload image to upscale</h3>
                    <p class="upload-subtitle">2x, 3x, or 4x enlargement</p>
                    <input type="file" id="upscaleFileInput" accept="image/*" style="display: none;" onchange="handleUpscaleUpload(this.files)">
                </div>

                <!-- Preview -->
                <div class="preview-section" id="upscalePreview" style="display: none;">
                    <div class="preview-card">
                        <h4><i class="fas fa-original"></i> Original</h4>
                        <img id="originalUpscaleImage" class="preview-image" src="" alt="Original">
                        <div class="preview-info" id="originalUpscaleInfo"></div>
                    </div>
                    <div class="preview-card">
                        <h4><i class="fas fa-expand"></i> Upscaled</h4>
                        <img id="upscaledImage" class="preview-image" src="" alt="Upscaled">
                        <div class="preview-info" id="upscaledInfo"></div>
                    </div>
                </div>

                <!-- Upscale Controls -->
                <div class="controls-grid" id="upscaleControls" style="display: none;">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-expand"></i>
                            <span>Upscale Factor</span>
                        </div>
                        
                        <div style="display: flex; gap: 1rem; justify-content: center; margin-bottom: 1.5rem;">
                            <button class="btn btn-outline" onclick="setUpscaleFactor(2)">2x</button>
                            <button class="btn btn-outline" onclick="setUpscaleFactor(3)">3x</button>
                            <button class="btn btn-outline" onclick="setUpscaleFactor(4)">4x</button>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>Enhancement</label>
                            <select id="upscaleEnhance" class="input-field">
                                <option value="standard">Standard</option>
                                <option value="smooth">Smooth</option>
                                <option value="sharp">Sharp</option>
                            </select>
                        </div>

                        <div style="background: var(--gray-light); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                            <div style="display: flex; justify-content: space-between;">
                                <span>Original Size:</span>
                                <span id="originalUpscaleDimensions">0 Ã— 0</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>Upscaled Size:</span>
                                <span id="upscaledDimensions">0 Ã— 0</span>
                            </div>
                        </div>

                        <button class="btn btn-primary" style="width: 100%;" onclick="processUpscale()">
                            <i class="fas fa-expand"></i> Upscale Image
                        </button>
                    </div>
                </div>

                <!-- Download Button -->
                <div class="btn-group" id="upscaleDownloadBtn" style="display: none;">
                    <button class="btn btn-success" onclick="downloadUpscaledImage()">
                        <i class="fas fa-download"></i> Download Upscaled Image
                    </button>
                    <button class="btn btn-outline" onclick="resetUpscaleTool()">
                        <i class="fas fa-redo"></i> Process Another
                    </button>
                </div>

                <!-- Progress -->
                <div class="progress-container" id="upscaleProgress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="upscaleProgressFill"></div>
                    </div>
                    <div class="progress-stats">
                        <span id="upscaleProgressText">Upscaling image...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- CONVERT TO WEBP PAGE -->
        <div data-page="convert-to-webp">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Convert to WebP</h1>
                    <p class="tool-description">Convert images to modern WebP format for better compression.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="webpUpload" onclick="document.getElementById('webpFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload image to convert</h3>
                    <p class="upload-subtitle">Convert to WebP, JPG, or PNG</p>
                    <input type="file" id="webpFileInput" accept="image/*" style="display: none;" onchange="handleWebPUpload(this.files)">
                </div>

                <!-- Preview -->
                <div class="preview-section" id="webpPreview" style="display: none;">
                    <div class="preview-card">
                        <h4><i class="fas fa-original"></i> Original</h4>
                        <img id="originalWebPImage" class="preview-image" src="" alt="Original">
                        <div class="preview-info" id="originalWebPInfo"></div>
                    </div>
                    <div class="preview-card">
                        <h4><i class="fas fa-file-image"></i> Converted</h4>
                        <img id="convertedWebPImage" class="preview-image" src="" alt="Converted">
                        <div class="preview-info" id="convertedWebPInfo"></div>
                    </div>
                </div>

                <!-- Conversion Controls -->
                <div class="controls-grid" id="webpControls" style="display: none;">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-exchange-alt"></i>
                            <span>Conversion Settings</span>
                        </div>
                        
                        <div style="margin-bottom: 1rem;">
                            <label>Output Format</label>
                            <select id="webpFormat" class="input-field" onchange="updateWebPControls()">
                                <option value="webp">WebP (Recommended)</option>
                                <option value="jpg">JPEG</option>
                                <option value="png">PNG</option>
                            </select>
                        </div>

                        <div id="webpQualityControl" style="margin-bottom: 1rem;">
                            <label>Quality</label>
                            <input type="range" id="webpQuality" class="input-field" min="1" max="100" value="85" oninput="updateWebPQualityLabel()">
                            <span id="webpQualityValue">85%</span>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>Resize (Optional)</label>
                            <label style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="checkbox" id="webpResize" onchange="toggleWebPResize()">
                                <span>Resize before conversion</span>
                            </label>
                        </div>

                        <div id="webpResizeControls" style="display: none; margin-bottom: 1rem;">
                            <div style="display: flex; gap: 0.5rem;">
                                <input type="number" id="webpWidth" class="input-field" placeholder="Width">
                                <span>Ã—</span>
                                <input type="number" id="webpHeight" class="input-field" placeholder="Height">
                            </div>
                            <label style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.5rem;">
                                <input type="checkbox" id="webpKeepAspect" checked>
                                <span>Keep aspect ratio</span>
                            </label>
                        </div>

                        <button class="btn btn-primary" style="width: 100%;" onclick="processWebPConversion()">
                            <i class="fas fa-exchange-alt"></i> Convert & Download
                        </button>
                    </div>
                </div>

                <!-- Download Button -->
                <div class="btn-group" id="webpDownloadBtn" style="display: none;">
                    <button class="btn btn-success" onclick="downloadWebPImage()">
                        <i class="fas fa-download"></i> Download Converted Image
                    </button>
                    <button class="btn btn-outline" onclick="resetWebPTool()">
                        <i class="fas fa-redo"></i> Convert Another
                    </button>
                </div>

                <!-- Progress -->
                <div class="progress-container" id="webpProgress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="webpProgressFill"></div>
                    </div>
                    <div class="progress-stats">
                        <span id="webpProgressText">Converting image...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- BATCH RESIZE PAGE -->
        <div data-page="batch-resize">
            <div class="tool-container">
                <div class="tool-header">
                    <h1 class="tool-title">Batch Resize</h1>
                    <p class="tool-description">Resize multiple images at once. Download as ZIP.</p>
                </div>

                <!-- Upload Area -->
                <div class="upload-area" id="batchUpload" onclick="document.getElementById('batchFileInput').click()">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3 class="upload-title">Upload multiple images</h3>
                    <p class="upload-subtitle">Select multiple files or drag & drop</p>
                    <input type="file" id="batchFileInput" accept="image/*" multiple style="display: none;" onchange="handleBatchUpload(this.files)">
                </div>

                <!-- File List -->
                <div id="batchFileList" style="display: none; margin-bottom: 1.5rem;">
                    <h4 style="margin-bottom: 1rem;">Selected Files</h4>
                    <div id="batchFileItems" style="max-height: 200px; overflow-y: auto; border: 2px solid var(--gray-light); border-radius: 12px; padding: 0.5rem;">
                        <!-- Files will be listed here -->
                    </div>
                </div>

                <!-- Batch Controls -->
                <div class="controls-grid" id="batchControls" style="display: none;">
                    <div class="control-group">
                        <div class="control-label">
                            <i class="fas fa-layer-group"></i>
                            <span>Batch Settings</span>
                        </div>
                        
                        <div style="margin-bottom: 1rem;">
                            <label>Resize Mode</label>
                            <select id="batchResizeMode" class="input-field">
                                <option value="percentage">Percentage</option>
                                <option value="dimensions">Exact Dimensions</option>
                                <option value="width">Fit to Width</option>
                                <option value="height">Fit to Height</option>
                            </select>
                        </div>

                        <div id="batchPercentageControl">
                            <label>Percentage</label>
                            <input type="range" id="batchPercentage" class="input-field" min="1" max="200" value="100" oninput="updateBatchPercentageLabel()">
                            <span id="batchPercentageValue">100%</span>
                        </div>

                        <div id="batchDimensionsControl" style="display: none;">
                            <div style="display: flex; gap: 0.5rem;">
                                <input type="number" id="batchWidth" class="input-field" placeholder="Width">
                                <span>Ã—</span>
                                <input type="number" id="batchHeight" class="input-field" placeholder="Height">
                            </div>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>Output Format</label>
                            <select id="batchFormat" class="input-field">
                                <option value="original">Keep Original</option>
                                <option value="jpg">JPEG</option>
                                <option value="png">PNG</option>
                                <option value="webp">WebP</option>
                            </select>
                        </div>

                        <div style="margin-bottom: 1rem;">
                            <label>Quality</label>
                            <input type="range" id="batchQuality" class="input-field" min="1" max="100" value="85" oninput="updateBatchQualityLabel()">
                            <span id="batchQualityValue">85%</span>
                        </div>

                        <button class="btn btn-primary" style="width: 100%;" onclick="processBatchResize()">
                            <i class="fas fa-layer-group"></i> Process Batch
                        </button>
                    </div>
                </div>

                <!-- Progress -->
                <div class="progress-container" id="batchProgress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="batchProgressFill"></div>
                    </div>
                    <div class="progress-stats">
                        <span id="batchProgressText">0/0 files processed</span>
                        <span id="batchProgressPercent">0%</span>
                    </div>
                </div>

                <!-- Download Button -->
                <div class="btn-group" id="batchDownloadBtn" style="display: none;">
                    <button class="btn btn-success" onclick="downloadBatchZip()">
                        <i class="fas fa-file-archive"></i> Download All as ZIP
                    </button>
                    <button class="btn btn-outline" onclick="resetBatchTool()">
                        <i class="fas fa-redo"></i> Process More
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Global State
        let currentImage = null;
        let originalImageData = null;
        let processedImageBlob = null;
        let currentFileName = '';
        let batchFiles = [];
        let batchProcessedBlobs = [];
        let watermarkImageData = null;
        let upscaleFactor = 2;
        let aspectRatioLocked = true;
        
        // Dropdown Toggle
        function toggleDropdown(id) {
            const dropdown = document.getElementById(id);
            dropdown.classList.toggle('active');
            
            // Close other dropdowns
            document.querySelectorAll('.dropdown').forEach(d => {
                if (d.id !== id) {
                    d.classList.remove('active');
                }
            });
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.dropdown')) {
                document.querySelectorAll('.dropdown').forEach(d => {
                    d.classList.remove('active');
                });
            }
        });

        // Search Functionality
        const searchTools = [
            { name: 'Resize by Percentage', url: 'resize-percentage', icon: 'fa-percent', category: 'Resize' },
            { name: 'Advanced Resize + Aspect', url: 'resize-aspect-ratio', icon: 'fa-arrows-alt', category: 'Resize' },
            { name: 'Resize with DPI', url: 'resize-dimensions', icon: 'fa-ruler', category: 'Resize' },
            { name: 'Compress Image', url: 'compress-image', icon: 'fa-compress', category: 'Compress' },
            { name: 'Optimize Image', url: 'optimize-image', icon: 'fa-magic', category: 'Optimize' },
            { name: 'Resize to KB', url: 'resize-to-kb', icon: 'fa-file', category: 'Compress' },
            { name: 'Crop Image', url: 'crop-image', icon: 'fa-crop', category: 'Crop' },
            { name: 'Rotate Image', url: 'rotate-image', icon: 'fa-undo-alt', category: 'Transform' },
            { name: 'Mirror Image', url: 'mirror-image', icon: 'fa-arrows-alt-h', category: 'Transform' },
            { name: 'Pixelate Image', url: 'pixelate-image', icon: 'fa-th', category: 'Effects' },
            { name: 'Social Media Resizer', url: 'social-media-resizer', icon: 'fa-share-alt', category: 'Social' },
            { name: 'Print Resize', url: 'print-resize', icon: 'fa-print', category: 'Print' },
            { name: 'Dimension Calculator', url: 'dimension-calculator', icon: 'fa-calculator', category: 'Tools' },
            { name: 'EXIF Viewer', url: 'exif-viewer', icon: 'fa-info-circle', category: 'Metadata' },
            { name: 'Add Watermark', url: 'add-watermark', icon: 'fa-copyright', category: 'Protect' },
            { name: 'Upscale Image', url: 'upscale-image', icon: 'fa-expand', category: 'Resize' },
            { name: 'Convert to WebP', url: 'convert-to-webp', icon: 'fa-file-image', category: 'Convert' },
            { name: 'Batch Resize', url: 'batch-resize', icon: 'fa-layer-group', category: 'Batch' }
        ];

        document.getElementById('globalSearch').addEventListener('input', function(e) {
            const query = e.target.value.toLowerCase();
            const results = document.getElementById('searchResults');
            
            if (query.length < 2) {
                results.classList.remove('active');
                return;
            }

            const matches = searchTools.filter(tool => 
                tool.name.toLowerCase().includes(query) ||
                tool.category.toLowerCase().includes(query)
            ).slice(0, 10);

            if (matches.length > 0) {
                results.innerHTML = matches.map(tool => `
                    <div class="search-result-item" onclick="showPage('${tool.url}')">
                        <i class="fas ${tool.icon}"></i>
                        <div>
                            <strong>${tool.name}</strong>
                            <small style="display: block; color: var(--gray);">${tool.category}</small>
                        </div>
                    </div>
                `).join('');
                results.classList.add('active');
            } else {
                results.innerHTML = '<div class="search-result-item">No tools found</div>';
                results.classList.add('active');
            }
        });

        // Close search results when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.search-container')) {
                document.getElementById('searchResults').classList.remove('active');
            }
        });

        // Page Navigation
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('[data-page]').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            document.querySelector(`[data-page="${pageId}"]`).classList.add('active');
            
            // Update breadcrumb
            const pageNames = {
                'home': 'Dashboard',
                'resize-percentage': 'Resize by Percentage',
                'resize-aspect-ratio': 'Advanced Resize + Aspect',
                'compress-image': 'Compress Image',
                'mirror-image': 'Mirror Image',
                'pixelate-image': 'Pixelate Image',
                'rotate-image': 'Rotate Image',
                'social-media-resizer': 'Social Media Resizer',
                'resize-to-kb': 'Resize to KB',
                'print-resize': 'Print Resize',
                'resize-dimensions': 'Resize with DPI',
                'dimension-calculator': 'Dimension Calculator',
                'crop-image': 'Crop Image',
                'optimize-image': 'Optimize Image',
                'exif-viewer': 'EXIF Viewer',
                'add-watermark': 'Add Watermark',
                'upscale-image': 'Image Upscaler',
                'convert-to-webp': 'Convert to WebP',
                'batch-resize': 'Batch Resize'
            };
            
            document.getElementById('currentPageName').textContent = pageNames[pageId] || pageId;
            
            // Close all dropdowns
            document.querySelectorAll('.dropdown').forEach(d => {
                d.classList.remove('active');
            });
            
            // Clear search
            document.getElementById('globalSearch').value = '';
            document.getElementById('searchResults').classList.remove('active');
        }

        // Toast Notifications
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            let icon = 'fa-check-circle';
            if (type === 'error') icon = 'fa-exclamation-circle';
            if (type === 'warning') icon = 'fa-exclamation-triangle';
            
            toast.innerHTML = `
                <i class="fas ${icon}"></i>
                <span>${message}</span>
            `;
            
            document.getElementById('toastContainer').appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideIn 0.3s reverse';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // File Size Formatter
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // ============= PERCENTAGE RESIZE FUNCTIONS =============
        let percentageOriginalImage = null;
        let percentageImageData = null;

        function handlePercentageUpload(files) {
            if (files.length > 0) {
                const file = files[0];
                currentFileName = file.name;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    percentageOriginalImage = new Image();
                    percentageOriginalImage.onload = function() {
                        document.getElementById('originalPercentageImage').src = e.target.result;
                        document.getElementById('percentagePreview').style.display = 'grid';
                        document.getElementById('percentageControls').style.display = 'block';
                        document.getElementById('percentageActions').style.display = 'flex';
                        
                        // Set original dimensions
                        document.getElementById('percentageWidth').value = percentageOriginalImage.width;
                        document.getElementById('percentageHeight').value = percentageOriginalImage.height;
                        
                        // Update info
                        document.getElementById('originalPercentageInfo').innerHTML = `
                            <strong>Dimensions:</strong> ${percentageOriginalImage.width} Ã— ${percentageOriginalImage.height}<br>
                            <strong>File Size:</strong> ${formatFileSize(file.size)}<br>
                            <strong>Format:</strong> ${file.type}
                        `;
                        
                        // Store original data
                        percentageImageData = e.target.result;
                    };
                    percentageOriginalImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function updatePercentageSlider() {
            const val = document.getElementById('percentageValue').value;
            document.getElementById('percentageSlider').value = val;
            updatePercentagePreview();
        }

        function updatePercentagePreview() {
            if (!percentageOriginalImage) return;
            
            const percentage = parseInt(document.getElementById('percentageSlider').value);
            document.getElementById('percentageValue').value = percentage;
            
            const keepAspect = document.getElementById('keepAspectPercentage').checked;
            let width = percentageOriginalImage.width;
            let height = percentageOriginalImage.height;
            
            if (keepAspect) {
                width = Math.round(percentageOriginalImage.width * (percentage / 100));
                height = Math.round(percentageOriginalImage.height * (percentage / 100));
            } else {
                // If custom dimensions, use the input values
                width = parseInt(document.getElementById('percentageWidth').value) || width;
                height = parseInt(document.getElementById('percentageHeight').value) || height;
            }
            
            document.getElementById('percentageWidth').value = width;
            document.getElementById('percentageHeight').value = height;
            
            // Create preview canvas
            const canvas = document.createElement('canvas');
            canvas.width = width;
            canvas.height = height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(percentageOriginalImage, 0, 0, width, height);
            
            document.getElementById('resizedPercentageImage').src = canvas.toDataURL('image/jpeg', 0.9);
            
            // Update info
            document.getElementById('resizedPercentageInfo').innerHTML = `
                <strong>Dimensions:</strong> ${width} Ã— ${height}<br>
                <strong>Scale:</strong> ${percentage}%<br>
                <strong>Preview Ready</strong>
            `;
        }

        function processPercentageResize() {
            const canvas = document.createElement('canvas');
            const width = parseInt(document.getElementById('percentageWidth').value);
            const height = parseInt(document.getElementById('percentageHeight').value);
            
            canvas.width = width;
            canvas.height = height;
            
            const ctx = canvas.getContext('2d');
            ctx.drawImage(percentageOriginalImage, 0, 0, width, height);
            
            // Show progress
            document.getElementById('percentageProgress').classList.add('active');
            document.getElementById('percentageProgressFill').style.width = '0%';
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                document.getElementById('percentageProgressFill').style.width = progress + '%';
                document.getElementById('percentageProgressText').textContent = progress + '% Complete';
                
                if (progress >= 100) {
                    clearInterval(interval);
                    
                    // Convert to blob
                    canvas.toBlob((blob) => {
                        processedImageBlob = blob;
                        document.getElementById('downloadPercentageBtn').style.display = 'block';
                        document.getElementById('percentageProgress').classList.remove('active');
                        
                        // Show success notification
                        showToast('Your image has been resized!', 'success');
                    }, 'image/jpeg', 0.9);
                }
            }, 50);
        }

        function downloadPercentageImage() {
            if (!processedImageBlob) return;
            
            const url = URL.createObjectURL(processedImageBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'resized_' + currentFileName;
            link.click();
            URL.revokeObjectURL(url);
            
            showToast('Download started!', 'success');
        }

        function resetPercentageTool() {
            document.getElementById('percentageFileInput').value = '';
            document.getElementById('percentagePreview').style.display = 'none';
            document.getElementById('percentageControls').style.display = 'none';
            document.getElementById('percentageActions').style.display = 'none';
            document.getElementById('downloadPercentageBtn').style.display = 'none';
            document.getElementById('percentageProgress').classList.remove('active');
            percentageOriginalImage = null;
            processedImageBlob = null;
        }

        // ============= ASPECT RATIO RESIZE FUNCTIONS =============
        let aspectOriginalImage = null;
        let aspectRatios = {
            '1x1': 1/1, '2x1': 2/1, '3x2': 3/2, '4x3': 4/3, '5x3': 5/3, '5x4': 5/4,
            '7x5': 7/5, '8x5': 8/5, '10x7': 10/7, '11x9': 11/9, '14x11': 14/11,
            '16x9': 16/9, 'a1': 0.707, 'a2': 0.707, 'a3': 0.707, 'a4': 0.707,
            'golden': 1.618, 'instagram-story': 9/16, 'pinterest': 2/3,
            'tumblr': 1/1, 'facebook-cover': 1.78, 'twitter-cover': 3/1,
            'linkedin-background': 4/1, 'youtube-cover': 16/9
        };

        function loadAspectPresets() {
            const category = document.getElementById('aspectRatioCategory').value;
            const grid = document.getElementById('aspectPresetGrid');
            
            let presets = [];
            
            if (category === 'standard') {
                presets = ['1x1', '2x1', '3x2', '4x3', '5x3', '5x4', '7x5', '8x5', '10x7', '11x9', '14x11', '16x9', 'golden'];
            } else if (category === 'social') {
                presets = ['instagram-story', 'pinterest', 'tumblr', 'facebook-cover', 'twitter-cover', 'linkedin-background', 'youtube-cover'];
            } else if (category === 'print') {
                presets = ['4x6', '5x7', '8x10', '11x14', '12x16', '16x20', '20x24'];
            } else if (category === 'paper') {
                presets = ['a1', 'a2', 'a3', 'a4'];
            }
            
            grid.innerHTML = presets.map(preset => `
                <div class="aspect-btn" onclick="selectAspectPreset('${preset}')">
                    ${preset.toUpperCase().replace('-', ' ')}
                </div>
            `).join('');
        }

        function selectAspectPreset(preset) {
            document.querySelectorAll('.aspect-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            let ratio = aspectRatios[preset];
            if (!ratio) {
                // Parse ratio from string like "4x6"
                const parts = preset.split('x');
                ratio = parseFloat(parts[0]) / parseFloat(parts[1]);
            }
            
            if (aspectOriginalImage) {
                let width, height;
                if (ratio > 1) {
                    width = aspectOriginalImage.width;
                    height = Math.round(width / ratio);
                } else {
                    height = aspectOriginalImage.height;
                    width = Math.round(height * ratio);
                }
                
                document.getElementById('aspectWidth').value = width;
                document.getElementById('aspectHeight').value = height;
                
                updateAspectCrop();
            }
        }

        function handleAspectUpload(files) {
            if (files.length > 0) {
                const file = files[0];
                currentFileName = file.name;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    aspectOriginalImage = new Image();
                    aspectOriginalImage.onload = function() {
                        document.getElementById('originalAspectImage').src = e.target.result;
                        document.getElementById('aspectPreview').style.display = 'grid';
                        document.getElementById('aspectControls').style.display = 'block';
                        
                        // Set initial dimensions
                        document.getElementById('aspectWidth').value = aspectOriginalImage.width;
                        document.getElementById('aspectHeight').value = aspectOriginalImage.height;
                        
                        // Load aspect presets
                        loadAspectPresets();
                        drawGridOverlay();
                    };
                    aspectOriginalImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function drawGridOverlay() {
            const canvas = document.getElementById('gridOverlay');
            if (!aspectOriginalImage) return;
            
            canvas.width = aspectOriginalImage.width;
            canvas.height = aspectOriginalImage.height;
            
            const ctx = canvas.getContext('2d');
            ctx.strokeStyle = 'rgba(37, 99, 235, 0.5)';
            ctx.lineWidth = 2;
            
            // Draw rule of thirds grid
            const thirdW = canvas.width / 3;
            const thirdH = canvas.height / 3;
            
            ctx.beginPath();
            ctx.moveTo(thirdW, 0);
            ctx.lineTo(thirdW, canvas.height);
            ctx.moveTo(thirdW * 2, 0);
            ctx.lineTo(thirdW * 2, canvas.height);
            ctx.moveTo(0, thirdH);
            ctx.lineTo(canvas.width, thirdH);
            ctx.moveTo(0, thirdH * 2);
            ctx.lineTo(canvas.width, thirdH * 2);
            ctx.stroke();
            
            // Draw center cross
            ctx.strokeStyle = 'rgba(255, 0, 0, 0.5)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(canvas.width / 2, 0);
            ctx.lineTo(canvas.width / 2, canvas.height);
            ctx.moveTo(0, canvas.height / 2);
            ctx.lineTo(canvas.width, canvas.height / 2);
            ctx.stroke();
        }

        function updateAspectCrop() {
            if (!aspectOriginalImage) return;
            
            const width = parseInt(document.getElementById('aspectWidth').value);
            const height = parseInt(document.getElementById('aspectHeight').value);
            const fitMode = document.getElementById('fitMode').checked;
            
            const canvas = document.createElement('canvas');
            canvas.width = width;
            canvas.height = height;
            
            const ctx = canvas.getContext('2d');
            
            if (fitMode) {
                // Fit mode - preserve entire image
                const scale = Math.min(width / aspectOriginalImage.width, height / aspectOriginalImage.height);
                const scaledW = aspectOriginalImage.width * scale;
                const scaledH = aspectOriginalImage.height * scale;
                const x = (width - scaledW) / 2;
                const y = (height - scaledH) / 2;
                
                ctx.fillStyle = 'white';
                ctx.fillRect(0, 0, width, height);
                ctx.drawImage(aspectOriginalImage, x, y, scaledW, scaledH);
            } else {
                // Fill mode - cover entire area
                const scale = Math.max(width / aspectOriginalImage.width, height / aspectOriginalImage.height);
                const scaledW = aspectOriginalImage.width * scale;
                const scaledH = aspectOriginalImage.height * scale;
                const x = (width - scaledW) / 2;
                const y = (height - scaledH) / 2;
                
                ctx.drawImage(aspectOriginalImage, x, y, scaledW, scaledH);
            }
            
            document.getElementById('resizedAspectImage').src = canvas.toDataURL('image/jpeg', 0.9);
            
            // Store for download
            canvas.toBlob((blob) => {
                processedImageBlob = blob;
            }, 'image/jpeg', 0.9);
        }

        function updateAspectFromDimensions() {
            if (!aspectOriginalImage) return;
            updateAspectCrop();
        }

        function processAspectResize() {
            updateAspectCrop();
            document.getElementById('aspectDownloadBtn').style.display = 'flex';
            showToast('Your image has been cropped and resized!', 'success');
        }

        function downloadAspectImage() {
            if (!processedImageBlob) return;
            
            const url = URL.createObjectURL(processedImageBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'cropped_' + currentFileName;
            link.click();
            URL.revokeObjectURL(url);
            
            showToast('Download started!', 'success');
        }

        function resetAspectTool() {
            document.getElementById('aspectFileInput').value = '';
            document.getElementById('aspectPreview').style.display = 'none';
            document.getElementById('aspectControls').style.display = 'none';
            document.getElementById('aspectDownloadBtn').style.display = 'none';
            aspectOriginalImage = null;
            processedImageBlob = null;
        }

        // ============= COMPRESS IMAGE FUNCTIONS =============
        let compressOriginalImage = null;

        function handleCompressUpload(files) {
            if (files.length > 0) {
                const file = files[0];
                currentFileName = file.name;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    compressOriginalImage = new Image();
                    compressOriginalImage.onload = function() {
                        document.getElementById('originalCompressImage').src = e.target.result;
                        document.getElementById('compressPreview').style.display = 'grid';
                        document.getElementById('compressControls').style.display = 'block';
                        document.getElementById('compressActions').style.display = 'flex';
                        
                        document.getElementById('originalCompressInfo').innerHTML = `
                            <strong>Dimensions:</strong> ${compressOriginalImage.width} Ã— ${compressOriginalImage.height}<br>
                            <strong>File Size:</strong> ${formatFileSize(file.size)}<br>
                            <strong>Format:</strong> ${file.type}
                        `;
                    };
                    compressOriginalImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function toggleCompressMethod() {
            const method = document.querySelector('input[name="compressMethod"]:checked').value;
            document.getElementById('autoCompressControls').style.display = method === 'auto' ? 'block' : 'none';
            document.getElementById('manualCompressControls').style.display = method === 'manual' ? 'block' : 'none';
        }

        function updateCompressQualityLabel() {
            const quality = document.getElementById('compressQuality').value;
            document.getElementById('compressQualityValue').textContent = quality + '%';
        }

        function updateTargetSizeLabel() {
            const size = document.getElementById('targetSizeSlider').value;
            document.getElementById('targetSizeValue').value = size;
            document.getElementById('targetSizeLabel').textContent = size + ' KB';
        }

        function updateTargetSizeSlider() {
            const size = document.getElementById('targetSizeValue').value;
            document.getElementById('targetSizeSlider').value = size;
            document.getElementById('targetSizeLabel').textContent = size + ' KB';
        }

        function toggleKBResolution() {
            const resolution = document.getElementById('targetResolution').value;
            document.getElementById('customResolutionControls').style.display = resolution === 'custom' ? 'block' : 'none';
        }

        function processCompression() {
            if (!compressOriginalImage) return;
            
            const method = document.querySelector('input[name="compressMethod"]:checked').value;
            
            document.getElementById('compressProgress').classList.add('active');
            document.getElementById('compressProgressFill').style.width = '0%';
            
            let quality = 0.8;
            let targetSize = null;
            
            if (method === 'auto') {
                quality = parseInt(document.getElementById('compressQuality').value) / 100;
            } else {
                targetSize = parseInt(document.getElementById('targetSizeValue').value) * 1024;
                quality = 0.7; // Start with medium quality
            }
            
            const canvas = document.createElement('canvas');
            
            // Check if custom resolution is selected
            if (document.getElementById('targetResolution').value === 'custom') {
                canvas.width = parseInt(document.getElementById('customWidth').value) || compressOriginalImage.width;
                canvas.height = parseInt(document.getElementById('customHeight').value) || compressOriginalImage.height;
            } else {
                canvas.width = compressOriginalImage.width;
                canvas.height = compressOriginalImage.height;
            }
            
            const ctx = canvas.getContext('2d');
            ctx.drawImage(compressOriginalImage, 0, 0, canvas.width, canvas.height);
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                document.getElementById('compressProgressFill').style.width = progress + '%';
                document.getElementById('compressProgressText').textContent = progress + '% Complete';
                
                if (progress >= 100) {
                    clearInterval(interval);
                    
                    canvas.toBlob((blob) => {
                        processedImageBlob = blob;
                        
                        // Update preview
                        const url = URL.createObjectURL(blob);
                        document.getElementById('compressedImage').src = url;
                        document.getElementById('compressedInfo').innerHTML = `
                            <strong>Dimensions:</strong> ${canvas.width} Ã— ${canvas.height}<br>
                            <strong>File Size:</strong> ${formatFileSize(blob.size)}<br>
                            <strong>Reduction:</strong> ${Math.round((1 - blob.size / compressOriginalImage.originalSize) * 100)}%
                        `;
                        
                        document.getElementById('downloadCompressedBtn').style.display = 'block';
                        document.getElementById('compressProgress').classList.remove('active');
                        
                        // Show success notification with file size reduction
                        const originalSize = compressOriginalImage.originalSize || 0;
                        showToast(`Your file was reduced from ${formatFileSize(originalSize)} to ${formatFileSize(blob.size)}!`, 'success');
                    }, 'image/jpeg', quality);
                }
            }, 50);
            
            // Store original file size
            compressOriginalImage.originalSize = document.getElementById('compressFileInput').files[0].size;
        }

        function downloadCompressedImage() {
            if (!processedImageBlob) return;
            
            const url = URL.createObjectURL(processedImageBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'compressed_' + currentFileName;
            link.click();
            URL.revokeObjectURL(url);
            
            showToast('Download started!', 'success');
        }

        function resetCompressTool() {
            document.getElementById('compressFileInput').value = '';
            document.getElementById('compressPreview').style.display = 'none';
            document.getElementById('compressControls').style.display = 'none';
            document.getElementById('compressActions').style.display = 'none';
            document.getElementById('downloadCompressedBtn').style.display = 'none';
            document.getElementById('compressProgress').classList.remove('active');
            compressOriginalImage = null;
            processedImageBlob = null;
        }

        // ============= MIRROR IMAGE FUNCTIONS =============
        let mirrorOriginalImage = null;

        function handleMirrorUpload(files) {
            if (files.length > 0) {
                const file = files[0];
                currentFileName = file.name;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    mirrorOriginalImage = new Image();
                    mirrorOriginalImage.onload = function() {
                        document.getElementById('originalMirrorImage').src = e.target.result;
                        document.getElementById('mirrorPreview').style.display = 'grid';
                        document.getElementById('mirrorControls').style.display = 'flex';
                        document.getElementById('mirrorDownloadBtn').style.display = 'none';
                    };
                    mirrorOriginalImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function applyMirror(direction) {
            if (!mirrorOriginalImage) return;
            
            const canvas = document.createElement('canvas');
            canvas.width = mirrorOriginalImage.width;
            canvas.height = mirrorOriginalImage.height;
            
            const ctx = canvas.getContext('2d');
            
            if (direction === 'horizontal') {
                ctx.translate(canvas.width, 0);
                ctx.scale(-1, 1);
            } else {
                ctx.translate(0, canvas.height);
                ctx.scale(1, -1);
            }
            
            ctx.drawImage(mirrorOriginalImage, 0, 0);
            
            canvas.toBlob((blob) => {
                processedImageBlob = blob;
                const url = URL.createObjectURL(blob);
                document.getElementById('mirroredImage').src = url;
                document.getElementById('mirrorDownloadBtn').style.display = 'flex';
                
                showToast('Image mirrored successfully!', 'success');
            }, 'image/jpeg', 0.9);
        }

        function downloadMirroredImage() {
            if (!processedImageBlob) return;
            
            const url = URL.createObjectURL(processedImageBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'mirrored_' + currentFileName;
            link.click();
            URL.revokeObjectURL(url);
            
            showToast('Download started!', 'success');
        }

        function resetMirrorTool() {
            document.getElementById('mirrorFileInput').value = '';
            document.getElementById('mirrorPreview').style.display = 'none';
            document.getElementById('mirrorControls').style.display = 'none';
            document.getElementById('mirrorDownloadBtn').style.display = 'none';
            mirrorOriginalImage = null;
            processedImageBlob = null;
        }

        // ============= PIXELATE IMAGE FUNCTIONS =============
        let pixelateOriginalImage = null;

        function handlePixelateUpload(files) {
            if (files.length > 0) {
                const file = files[0];
                currentFileName = file.name;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    pixelateOriginalImage = new Image();
                    pixelateOriginalImage.onload = function() {
                        document.getElementById('originalPixelateImage').src = e.target.result;
                        document.getElementById('pixelatePreview').style.display = 'grid';
                        document.getElementById('pixelateControls').style.display = 'block';
                        document.getElementById('pixelateDownloadBtn').style.display = 'none';
                    };
                    pixelateOriginalImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function updatePixelatePreview() {
            if (!pixelateOriginalImage) return;
            
            const level = parseInt(document.getElementById('pixelateLevel').value);
            document.getElementById('pixelateLevelValue').textContent = level + 'px';
            
            const canvas = document.createElement('canvas');
            canvas.width = pixelateOriginalImage.width;
            canvas.height = pixelateOriginalImage.height;
            
            const ctx = canvas.getContext('2d');
            
            // Draw small version then scale up
            const smallCanvas = document.createElement('canvas');
            smallCanvas.width = Math.max(1, Math.floor(pixelateOriginalImage.width / level));
            smallCanvas.height = Math.max(1, Math.floor(pixelateOriginalImage.height / level));
            
            const smallCtx = smallCanvas.getContext('2d');
            smallCtx.drawImage(pixelateOriginalImage, 0, 0, smallCanvas.width, smallCanvas.height);
            
            // Check black & white mode
            if (document.getElementById('blackWhiteMode').checked) {
                const imageData = smallCtx.getImageData(0, 0, smallCanvas.width, smallCanvas.height);
                for (let i = 0; i < imageData.data.length; i += 4) {
                    const gray = (imageData.data[i] + imageData.data[i+1] + imageData.data[i+2]) / 3;
                    imageData.data[i] = gray;
                    imageData.data[i+1] = gray;
                    imageData.data[i+2] = gray;
                }
                smallCtx.putImageData(imageData, 0, 0);
            }
            
            // Scale up
            ctx.imageSmoothingEnabled = false;
            ctx.drawImage(smallCanvas, 0, 0, canvas.width, canvas.height);
            
            canvas.toBlob((blob) => {
                const url = URL.createObjectURL(blob);
                document.getElementById('pixelatedImage').src = url;
            }, 'image/jpeg', 0.9);
        }

        function applyPixelation() {
            updatePixelatePreview();
            document.getElementById('pixelateDownloadBtn').style.display = 'flex';
            showToast('Pixelation effect applied!', 'success');
        }

        function downloadPixelatedImage() {
            const canvas = document.createElement('canvas');
            canvas.width = pixelateOriginalImage.width;
            canvas.height = pixelateOriginalImage.height;
            
            const ctx = canvas.getContext('2d');
            const level = parseInt(document.getElementById('pixelateLevel').value);
            
            const smallCanvas = document.createElement('canvas');
            smallCanvas.width = Math.max(1, Math.floor(pixelateOriginalImage.width / level));
            smallCanvas.height = Math.max(1, Math.floor(pixelateOriginalImage.height / level));
            
            const smallCtx = smallCanvas.getContext('2d');
            smallCtx.drawImage(pixelateOriginalImage, 0, 0, smallCanvas.width, smallCanvas.height);
            
            if (document.getElementById('blackWhiteMode').checked) {
                const imageData = smallCtx.getImageData(0, 0, smallCanvas.width, smallCanvas.height);
                for (let i = 0; i < imageData.data.length; i += 4) {
                    const gray = (imageData.data[i] + imageData.data[i+1] + imageData.data[i+2]) / 3;
                    imageData.data[i] = gray;
                    imageData.data[i+1] = gray;
                    imageData.data[i+2] = gray;
                }
                smallCtx.putImageData(imageData, 0, 0);
            }
            
            ctx.imageSmoothingEnabled = false;
            ctx.drawImage(smallCanvas, 0, 0, canvas.width, canvas.height);
            
            canvas.toBlob((blob) => {
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'pixelated_' + currentFileName;
                link.click();
                URL.revokeObjectURL(url);
            }, 'image/jpeg', 0.9);
            
            showToast('Download started!', 'success');
        }

        function resetPixelateTool() {
            document.getElementById('pixelateFileInput').value = '';
            document.getElementById('pixelatePreview').style.display = 'none';
            document.getElementById('pixelateControls').style.display = 'none';
            document.getElementById('pixelateDownloadBtn').style.display = 'none';
            pixelateOriginalImage = null;
        }

        // ============= ROTATE IMAGE FUNCTIONS =============
        let rotateOriginalImage = null;

        function handleRotateUpload(files) {
            if (files.length > 0) {
                const file = files[0];
                currentFileName = file.name;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    rotateOriginalImage = new Image();
                    rotateOriginalImage.onload = function() {
                        document.getElementById('originalRotateImage').src = e.target.result;
                        document.getElementById('rotatePreview').style.display = 'grid';
                        document.getElementById('rotateControls').style.display = 'block';
                        document.getElementById('rotateDownloadBtn').style.display = 'none';
                    };
                    rotateOriginalImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function updateCustomAngleLabel() {
            const angle = document.getElementById('customAngle').value;
            document.getElementById('angleValue').value = angle;
            document.getElementById('angleLabel').textContent = angle + 'Â°';
        }

        function updateAngleSlider() {
            const angle = document.getElementById('angleValue').value;
            document.getElementById('customAngle').value = angle;
            document.getElementById('angleLabel').textContent = angle + 'Â°';
        }

        function rotateImage(angle) {
            if (!rotateOriginalImage) return;
            
            const canvas = document.createElement('canvas');
            const radians = angle * Math.PI / 180;
            
            if (angle % 180 !== 0) {
                canvas.width = rotateOriginalImage.height;
                canvas.height = rotateOriginalImage.width;
            } else {
                canvas.width = rotateOriginalImage.width;
                canvas.height = rotateOriginalImage.height;
            }
            
            const ctx = canvas.getContext('2d');
            ctx.translate(canvas.width / 2, canvas.height / 2);
            ctx.rotate(radians);
            ctx.drawImage(rotateOriginalImage, -rotateOriginalImage.width / 2, -rotateOriginalImage.height / 2);
            
            canvas.toBlob((blob) => {
                processedImageBlob = blob;
                const url = URL.createObjectURL(blob);
                document.getElementById('rotatedImage').src = url;
                document.getElementById('rotateDownloadBtn').style.display = 'flex';
                
                showToast(`Image rotated ${angle}Â°!`, 'success');
            }, 'image/jpeg', 0.9);
        }

        function applyCustomRotation() {
            const angle = parseInt(document.getElementById('customAngle').value);
            rotateImage(angle);
        }

        function downloadRotatedImage() {
            if (!processedImageBlob) return;
            
            const url = URL.createObjectURL(processedImageBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'rotated_' + currentFileName;
            link.click();
            URL.revokeObjectURL(url);
            
            showToast('Download started!', 'success');
        }

        function resetRotateTool() {
            document.getElementById('rotateFileInput').value = '';
            document.getElementById('rotatePreview').style.display = 'none';
            document.getElementById('rotateControls').style.display = 'none';
            document.getElementById('rotateDownloadBtn').style.display = 'none';
            rotateOriginalImage = null;
            processedImageBlob = null;
        }

        // ============= SOCIAL MEDIA RESIZER FUNCTIONS =============
        let socialOriginalImage = null;

        function handleSocialUpload(files) {
            if (files.length > 0) {
                const file = files[0];
                currentFileName = file.name;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    socialOriginalImage = new Image();
                    socialOriginalImage.onload = function() {
                        document.getElementById('originalSocialImage').src = e.target.result;
                        document.getElementById('socialPreview').style.display = 'grid';
                        document.getElementById('socialControls').style.display = 'block';
                        document.getElementById('socialDownloadBtn').style.display = 'none';
                        
                        document.getElementById('originalSocialInfo').innerHTML = `
                            <strong>Dimensions:</strong> ${socialOriginalImage.width} Ã— ${socialOriginalImage.height}<br>
                            <strong>Aspect Ratio:</strong> ${(socialOriginalImage.width / socialOriginalImage.height).toFixed(2)}:1
                        `;
                        
                        updateSocialPreset();
                    };
                    socialOriginalImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function updateSocialPreset() {
            const platform = document.getElementById('socialPlatform').value;
            let width, height;
            
            switch(platform) {
                case 'ig-post': width = 1080; height = 1080; break;
                case 'ig-portrait': width = 1080; height = 1350; break;
                case 'ig-landscape': width = 1080; height = 566; break;
                case 'ig-story': width = 1080; height = 1920; break;
                case 'ig-reels': width = 1080; height = 1920; break;
                case 'ig-profile': width = 320; height = 320; break;
                case 'fb-post': width = 1200; height = 630; break;
                case 'fb-cover': width = 820; height = 462; break;
                case 'fb-event': width = 1920; height = 1005; break;
                case 'fb-profile': width = 180; height = 180; break;
                case 'tw-post': width = 1200; height = 675; break;
                case 'tw-header': width = 1500; height = 500; break;
                case 'tw-profile': width = 400; height = 400; break;
                case 'li-post': width = 1200; height = 627; break;
                case 'li-cover': width = 1584; height = 396; break;
                case 'li-profile': width = 400; height = 400; break;
                case 'pin-pin': width = 1000; height = 1500; break;
                case 'pin-profile': width = 165; height = 165; break;
                case 'yt-thumbnail': width = 1280; height = 720; break;
                case 'yt-cover': width = 2560; height = 1440; break;
                case 'yt-profile': width = 800; height = 800; break;
                default: width = 1080; height = 1080;
            }
            
            document.getElementById('socialWidth').value = width;
            document.getElementById('socialHeight').value = height;
            
            // Show/hide background color picker
            const bgType = document.getElementById('backgroundType').value;
            document.getElementById('bgColorPicker').style.display = bgType === 'color' ? 'block' : 'none';
        }

        function processSocialResize() {
            if (!socialOriginalImage) return;
            
            const width = parseInt(document.getElementById('socialWidth').value);
            const height = parseInt(document.getElementById('socialHeight').value);
            const resizeType = document.getElementById('resizeType').value;
            const bgType = document.getElementById('backgroundType').value;
            const bgColor = document.getElementById('bgColor').value;
            
            const canvas = document.createElement('canvas');
            canvas.width = width;
            canvas.height = height;
            
            const ctx = canvas.getContext('2d');
            
            // Handle background
            if (bgType === 'color') {
                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, width, height);
            } else if (bgType === 'blur') {
                // Create blurred background
                const tempCanvas = document.createElement('canvas');
                tempCanvas.width = width;
                tempCanvas.height = height;
                const tempCtx = tempCanvas.getContext('2d');
                tempCtx.drawImage(socialOriginalImage, 0, 0, width, height);
                
                // Apply blur effect
                ctx.filter = 'blur(20px)';
                ctx.drawImage(tempCanvas, 0, 0, width, height);
                ctx.filter = 'none';
            }
            
            // Place image based on resize type
            if (resizeType === 'fit') {
                const scale = Math.min(width / socialOriginalImage.width, height / socialOriginalImage.height);
                const scaledW = socialOriginalImage.width * scale;
                const scaledH = socialOriginalImage.height * scale;
                const x = (width - scaledW) / 2;
                const y = (height - scaledH) / 2;
                ctx.drawImage(socialOriginalImage, x, y, scaledW, scaledH);
            } else if (resizeType === 'fill') {
                const scale = Math.max(width / socialOriginalImage.width, height / socialOriginalImage.height);
                const scaledW = socialOriginalImage.width * scale;
                const scaledH = socialOriginalImage.height * scale;
                const x = (width - scaledW) / 2;
                const y = (height - scaledH) / 2;
                ctx.drawImage(socialOriginalImage, x, y, scaledW, scaledH);
            } else {
                // Stretch
                ctx.drawImage(socialOriginalImage, 0, 0, width, height);
            }
            
            canvas.toBlob((blob) => {
                processedImageBlob = blob;
                const url = URL.createObjectURL(blob);
                document.getElementById('socialResizedImage').src = url;
                document.getElementById('socialResizedInfo').innerHTML = `
                    <strong>Dimensions:</strong> ${width} Ã— ${height}<br>
                    <strong>File Size:</strong> ${formatFileSize(blob.size)}<br>
                    <strong>Ready for ${document.getElementById('socialPlatform').selectedOptions[0].text}</strong>
                `;
                document.getElementById('socialDownloadBtn').style.display = 'flex';
                
                showToast('Image optimized for social media!', 'success');
            }, 'image/jpeg', 0.9);
        }

        function downloadSocialImage() {
            if (!processedImageBlob) return;
            
            const url = URL.createObjectURL(processedImageBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'social_' + currentFileName;
            link.click();
            URL.revokeObjectURL(url);
            
            showToast('Download started!', 'success');
        }

        function resetSocialTool() {
            document.getElementById('socialFileInput').value = '';
            document.getElementById('socialPreview').style.display = 'none';
            document.getElementById('socialControls').style.display = 'none';
            document.getElementById('socialDownloadBtn').style.display = 'none';
            socialOriginalImage = null;
            processedImageBlob = null;
        }

        // ============= RESIZE TO KB FUNCTIONS =============
        let kbOriginalImage = null;

        function handleKBUpload(files) {
            if (files.length > 0) {
                const file = files[0];
                currentFileName = file.name;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    kbOriginalImage = new Image();
                    kbOriginalImage.onload = function() {
                        document.getElementById('originalKBImage').src = e.target.result;
                        document.getElementById('kbPreview').style.display = 'grid';
                        document.getElementById('kbControls').style.display = 'block';
                        document.getElementById('kbDownloadBtn').style.display = 'none';
                        
                        document.getElementById('originalKBInfo').innerHTML = `
                            <strong>Dimensions:</strong> ${kbOriginalImage.width} Ã— ${kbOriginalImage.height}<br>
                            <strong>File Size:</strong> ${formatFileSize(file.size)}<br>
                            <strong>Format:</strong> ${file.type}
                        `;
                    };
                    kbOriginalImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function updateKBPreset() {
            const preset = document.getElementById('kbPreset').value;
            document.getElementById('customKBSize').style.display = preset === 'custom' ? 'block' : 'none';
        }

        function toggleKBResolution() {
            const resolution = document.getElementById('kbResolution').value;
            document.getElementById('kbCustomResolution').style.display = resolution === 'custom' ? 'block' : 'none';
        }

        function processKBResize() {
            if (!kbOriginalImage) return;
            
            let targetSizeKB = parseInt(document.getElementById('kbPreset').value);
            
            if (targetSizeKB === 'custom') {
                const customValue = parseInt(document.getElementById('customKBValue').value) || 100;
                const unit = document.getElementById('customKBUnit').value;
                targetSizeKB = unit === 'MB' ? customValue * 1024 : customValue;
            }
            
            const targetSizeBytes = targetSizeKB * 1024;
            
            document.getElementById('kbProgress').classList.add('active');
            document.getElementById('kbProgressFill').style.width = '0%';
            
            const canvas = document.createElement('canvas');
            
            // Check for custom resolution
            if (document.getElementById('kbResolution').value === 'custom') {
                let width = parseInt(document.getElementById('kbWidth').value) || kbOriginalImage.width;
                let height = parseInt(document.getElementById('kbHeight').value) || kbOriginalImage.height;
                
                if (document.getElementById('kbKeepAspect').checked) {
                    const aspectRatio = kbOriginalImage.width / kbOriginalImage.height;
                    if (width) {
                        height = Math.round(width / aspectRatio);
                    } else if (height) {
                        width = Math.round(height * aspectRatio);
                    }
                }
                
                canvas.width = width;
                canvas.height = height;
            } else {
                canvas.width = kbOriginalImage.width;
                canvas.height = kbOriginalImage.height;
            }
            
            const ctx = canvas.getContext('2d');
            ctx.drawImage(kbOriginalImage, 0, 0, canvas.width, canvas.height);
            
            // Binary search for quality to achieve target size
            let minQuality = 0.1;
            let maxQuality = 0.95;
            let bestQuality = 0.7;
            let bestBlob = null;
            let bestSize = Infinity;
            
            const tryQuality = (quality) => {
                return new Promise((resolve) => {
                    canvas.toBlob((blob) => {
                        resolve({ quality, blob, size: blob.size });
                    }, 'image/jpeg', quality);
                });
            };
            
            const findBestQuality = async () => {
                for (let i = 0; i < 10; i++) {
                    const quality = (minQuality + maxQuality) / 2;
                    const result = await tryQuality(quality);
                    
                    const progress = (i + 1) * 10;
                    document.getElementById('kbProgressFill').style.width = progress + '%';
                    document.getElementById('kbProgressText').textContent = `Optimizing... ${progress}%`;
                    
                    if (Math.abs(result.size - targetSizeBytes) < 1024) {
                        bestBlob = result.blob;
                        bestQuality = result.quality;
                        break;
                    }
                    
                    if (result.size > targetSizeBytes) {
                        maxQuality = quality;
                    } else {
                        minQuality = quality;
                        bestBlob = result.blob;
                        bestQuality = result.quality;
                    }
                }
                
                document.getElementById('kbProgress').classList.remove('active');
                
                if (bestBlob) {
                    processedImageBlob = bestBlob;
                    const url = URL.createObjectURL(bestBlob);
                    document.getElementById('resizedKBImage').src = url;
                    document.getElementById('resizedKBInfo').innerHTML = `
                        <strong>Dimensions:</strong> ${canvas.width} Ã— ${canvas.height}<br>
                        <strong>File Size:</strong> ${formatFileSize(bestBlob.size)}<br>
                        <strong>Target:</strong> ${targetSizeKB} KB<br>
                        <strong>Quality:</strong> ${Math.round(bestQuality * 100)}%
                    `;
                    document.getElementById('kbDownloadBtn').style.display = 'flex';
                    
                    showToast(`Image optimized to ${formatFileSize(bestBlob.size)}!`, 'success');
                }
            };
            
            findBestQuality();
        }

        function downloadKBImage() {
            if (!processedImageBlob) return;
            
            const url = URL.createObjectURL(processedImageBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'optimized_' + currentFileName;
            link.click();
            URL.revokeObjectURL(url);
            
            showToast('Download started!', 'success');
        }

        function resetKBTool() {
            document.getElementById('kbFileInput').value = '';
            document.getElementById('kbPreview').style.display = 'none';
            document.getElementById('kbControls').style.display = 'none';
            document.getElementById('kbDownloadBtn').style.display = 'none';
            document.getElementById('kbProgress').classList.remove('active');
            kbOriginalImage = null;
            processedImageBlob = null;
        }

        // ============= PRINT RESIZE FUNCTIONS =============
        let printOriginalImage = null;

        function handlePrintUpload(files) {
            if (files.length > 0) {
                const file = files[0];
                currentFileName = file.name;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    printOriginalImage = new Image();
                    printOriginalImage.onload = function() {
                        document.getElementById('originalPrintImage').src = e.target.result;
                        document.getElementById('printPreview').style.display = 'grid';
                        document.getElementById('printControls').style.display = 'block';
                        document.getElementById('printDownloadBtn').style.display = 'none';
                        
                        document.getElementById('originalPrintInfo').innerHTML = `
                            <strong>Dimensions:</strong> ${printOriginalImage.width} Ã— ${printOriginalImage.height} px<br>
                            <strong>File Size:</strong> ${formatFileSize(file.size)}<br>
                            <strong>Resolution:</strong> 72 DPI (estimated)
                        `;
                        
                        applyPrintPreset();
                    };
                    printOriginalImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function updatePrintUnit() {
            applyPrintPreset();
        }

        function applyPrintPreset() {
            const preset = document.getElementById('printPreset').value;
            const unit = document.getElementById('printUnit').value;
            const dpi = parseInt(document.getElementById('printDPI').value);
            
            document.getElementById('customPrintSize').style.display = preset === 'custom' ? 'block' : 'none';
            
            if (preset === 'custom') return;
            
            let width, height;
            
            // Standard sizes in inches
            switch(preset) {
                case 'letter': width = 8.5; height = 11; break;
                case 'legal': width = 8.5; height = 14; break;
                case 'tabloid': width = 11; height = 17; break;
                case '4x6': width = 4; height = 6; break;
                case '5x7': width = 5; height = 7; break;
                case '8x10': width = 8; height = 10; break;
                case '11x14': width = 11; height = 14; break;
                case '12x16': width = 12; height = 16; break;
                case '16x20': width = 16; height = 20; break;
                case '20x24': width = 20; height = 24; break;
                case '20x30': width = 20; height = 30; break;
                case '24x36': width = 24; height = 36; break;
                case 'a0': width = 33.1; height = 46.8; break;
                case 'a1': width = 23.4; height = 33.1; break;
                case 'a2': width = 16.5; height = 23.4; break;
                case 'a3': width = 11.7; height = 16.5; break;
                case 'a4': width = 8.3; height = 11.7; break;
                case 'a5': width = 5.8; height = 8.3; break;
                case 'a6': width = 4.1; height = 5.8; break;
                default: width = 8.5; height = 11;
            }
            
            // Convert to selected unit
            if (unit === 'cm') {
                width *= 2.54;
                height *= 2.54;
            } else if (unit === 'mm') {
                width *= 25.4;
                height *= 25.4;
            }
            
            document.getElementById('printWidth').value = width.toFixed(2);
            document.getElementById('printHeight').value = height.toFixed(2);
            
            updatePrintDPI();
        }

        function updatePrintDPI() {
            const dpi = parseInt(document.getElementById('printDPI').value);
            const unit = document.getElementById('printUnit').value;
            const width = parseFloat(document.getElementById('printWidth').value) || 0;
            const height = parseFloat(document.getElementById('printHeight').value) || 0;
            
            // Convert to inches for DPI calculation
            let widthInches = width;
            let heightInches = height;
            
            if (unit === 'cm') {
                widthInches /= 2.54;
                heightInches /= 2.54;
            } else if (unit === 'mm') {
                widthInches /= 25.4;
                heightInches /= 25.4;
            }
            
            const pixelWidth = Math.round(widthInches * dpi);
            const pixelHeight = Math.round(heightInches * dpi);
            
            document.getElementById('printSizeDisplay').textContent = `${width} Ã— ${height} ${unit}`;
            document.getElementById('pixelSizeDisplay').textContent = `${pixelWidth} Ã— ${pixelHeight} px`;
            
            const fileSize = (pixelWidth * pixelHeight * 3) / (1024 * 1024);
            document.getElementById('fileSizeEstimate').textContent = fileSize.toFixed(2) + ' MB';
        }

        function processPrintResize() {
            if (!printOriginalImage) return;
            
            const dpi = parseInt(document.getElementById('printDPI').value);
            const unit = document.getElementById('printUnit').value;
            let width = parseFloat(document.getElementById('printWidth').value);
            let height = parseFloat(document.getElementById('printHeight').value);
            
            // Convert to inches
            if (unit === 'cm') {
                width /= 2.54;
                height /= 2.54;
            } else if (unit === 'mm') {
                width /= 25.4;
                height /= 25.4;
            }
            
            const pixelWidth = Math.round(width * dpi);
            const pixelHeight = Math.round(height * dpi);
            
            const canvas = document.createElement('canvas');
            canvas.width = pixelWidth;
            canvas.height = pixelHeight;
            
            const ctx = canvas.getContext('2d');
            ctx.drawImage(printOriginalImage, 0, 0, pixelWidth, pixelHeight);
            
            const format = document.getElementById('printFormat').value;
            let mimeType = 'image/jpeg';
            let extension = 'jpg';
            
            if (format === 'png') {
                mimeType = 'image/png';
                extension = 'png';
            } else if (format === 'webp') {
                mimeType = 'image/webp';
                extension = 'webp';
            } else if (format === 'pdf') {
                // For PDF, we'll create a data URL
                mimeType = 'application/pdf';
                extension = 'pdf';
            }
            
            canvas.toBlob((blob) => {
                processedImageBlob = blob;
                const url = URL.createObjectURL(blob);
                document.getElementById('printReadyImage').src = url;
                document.getElementById('printReadyInfo').innerHTML = `
                    <strong>Print Size:</strong> ${document.getElementById('printSizeDisplay').textContent}<br>
                    <strong>Pixels:</strong> ${pixelWidth} Ã— ${pixelHeight} px<br>
                    <strong>DPI:</strong> ${dpi}<br>
                    <strong>Format:</strong> ${format.toUpperCase()}
                `;
                document.getElementById('printDownloadBtn').style.display = 'flex';
                
                showToast('Image ready for printing!', 'success');
            }, mimeType, 0.95);
        }

        function downloadPrintImage() {
            if (!processedImageBlob) return;
            
            const url = URL.createObjectURL(processedImageBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'print_' + currentFileName.replace(/\.[^/.]+$/, '') + '.' + document.getElementById('printFormat').value;
            link.click();
            URL.revokeObjectURL(url);
            
            showToast('Download started!', 'success');
        }

        function resetPrintTool() {
            document.getElementById('printFileInput').value = '';
            document.getElementById('printPreview').style.display = 'none';
            document.getElementById('printControls').style.display = 'none';
            document.getElementById('printDownloadBtn').style.display = 'none';
            printOriginalImage = null;
            processedImageBlob = null;
        }

        // ============= DIMENSION CALCULATOR =============
        function calculateDimensions() {
            const fromUnit = document.getElementById('calcFromUnit').value;
            const toUnit = document.getElementById('calcToUnit').value;
            let width = parseFloat(document.getElementById('calcWidth').value) || 0;
            let height = parseFloat(document.getElementById('calcHeight').value) || 0;
            const dpi = parseInt(document.getElementById('calcDPI').value) || 96;
            
            // Convert to pixels first
            if (fromUnit === 'in') {
                width *= dpi;
                height *= dpi;
            } else if (fromUnit === 'cm') {
                width *= dpi / 2.54;
                height *= dpi / 2.54;
            } else if (fromUnit === 'mm') {
                width *= dpi / 25.4;
                height *= dpi / 25.4;
            }
            
            // Convert to target unit
            let widthResult = width;
            let heightResult = height;
            let unitLabel = 'px';
            
            if (toUnit === 'in') {
                widthResult /= dpi;
                heightResult /= dpi;
                unitLabel = 'in';
            } else if (toUnit === 'cm') {
                widthResult = (width / dpi) * 2.54;
                heightResult = (height / dpi) * 2.54;
                unitLabel = 'cm';
            } else if (toUnit === 'mm') {
                widthResult = (width / dpi) * 25.4;
                heightResult = (height / dpi) * 25.4;
                unitLabel = 'mm';
            }
            
            document.getElementById('calcResultWidth').textContent = `${widthResult.toFixed(2)} ${unitLabel}`;
            document.getElementById('calcResultHeight').textContent = `${heightResult.toFixed(2)} ${unitLabel}`;
            
            // Calculate aspect ratio
            const aspect = width / height;
            document.getElementById('calcAspectRatio').textContent = aspect.toFixed(2);
            
            // Calculate megapixels
            const megapixels = (width * height) / 1000000;
            document.getElementById('calcMegapixelsResult').textContent = megapixels.toFixed(2) + ' MP';
        }

        function swapConversionUnits() {
            const fromUnit = document.getElementById('calcFromUnit').value;
            const toUnit = document.getElementById('calcToUnit').value;
            document.getElementById('calcFromUnit').value = toUnit;
            document.getElementById('calcToUnit').value = fromUnit;
            calculateDimensions();
        }

        function resetCalculator() {
            document.getElementById('calcWidth').value = 1920;
            document.getElementById('calcHeight').value = 1080;
            document.getElementById('calcDPI').value = 96;
            calculateDimensions();
        }

        // Initialize calculator
        calculateDimensions();

        // ============= CROP IMAGE FUNCTIONS =============
        let cropOriginalImage = null;

        function handleCropUpload(files) {
            if (files.length > 0) {
                const file = files[0];
                currentFileName = file.name;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    cropOriginalImage = new Image();
                    cropOriginalImage.onload = function() {
                        document.getElementById('cropImage').src = e.target.result;
                        document.getElementById('cropPreview').style.display = 'grid';
                        document.getElementById('cropControls').style.display = 'block';
                        document.getElementById('cropDownloadBtn').style.display = 'none';
                        
                        // Set max crop dimensions
                        document.getElementById('cropX').max = cropOriginalImage.width - 1;
                        document.getElementById('cropY').max = cropOriginalImage.height - 1;
                        document.getElementById('cropWidth').max = cropOriginalImage.width;
                        document.getElementById('cropHeight').max = cropOriginalImage.height;
                        
                        // Set default crop to half size
                        document.getElementById('cropWidth').value = Math.min(500, cropOriginalImage.width);
                        document.getElementById('cropHeight').value = Math.min(500, cropOriginalImage.height);
                        
                        updateCropPreview();
                    };
                    cropOriginalImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function updateCropPreview() {
            if (!cropOriginalImage) return;
            
            const x = parseInt(document.getElementById('cropX').value);
            const y = parseInt(document.getElementById('cropY').value);
            const width = parseInt(document.getElementById('cropWidth').value);
            const height = parseInt(document.getElementById('cropHeight').value);
            
            // Update overlay
            const overlay = document.getElementById('cropOverlay');
            const img = document.getElementById('cropImage');
            
            const scale = img.width / cropOriginalImage.width;
            
            overlay.style.left = (x * scale) + 'px';
            overlay.style.top = (y * scale) + 'px';
            overlay.style.width = (width * scale) + 'px';
            overlay.style.height = (height * scale) + 'px';
            
            // Create cropped preview
            const canvas = document.createElement('canvas');
            canvas.width = width;
            canvas.height = height;
            
            const ctx = canvas.getContext('2d');
            ctx.drawImage(cropOriginalImage, x, y, width, height, 0, 0, width, height);
            
            document.getElementById('croppedImage').src = canvas.toDataURL('image/jpeg', 0.9);
            
            canvas.toBlob((blob) => {
                processedImageBlob = blob;
            }, 'image/jpeg', 0.9);
        }

        function applyCropAspect() {
            const aspect = document.getElementById('cropAspect').value;
            if (aspect === 'custom') return;
            
            const ratio = eval(aspect.replace(':', '/'));
            const currentWidth = parseInt(document.getElementById('cropWidth').value);
            document.getElementById('cropHeight').value = Math.round(currentWidth / ratio);
            
            updateCropPreview();
        }

        function processCrop() {
            updateCropPreview();
            document.getElementById('cropDownloadBtn').style.display = 'flex';
            showToast('Image cropped successfully!', 'success');
        }

        function downloadCroppedImage() {
            if (!processedImageBlob) return;
            
            const url = URL.createObjectURL(processedImageBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'cropped_' + currentFileName;
            link.click();
            URL.revokeObjectURL(url);
            
            showToast('Download started!', 'success');
        }

        function resetCropTool() {
            document.getElementById('cropFileInput').value = '';
            document.getElementById('cropPreview').style.display = 'none';
            document.getElementById('cropControls').style.display = 'none';
            document.getElementById('cropDownloadBtn').style.display = 'none';
            cropOriginalImage = null;
            processedImageBlob = null;
        }

        // ============= OPTIMIZE IMAGE FUNCTIONS =============
        let optimizeOriginalImage = null;

        function handleOptimizeUpload(files) {
            if (files.length > 0) {
                const file = files[0];
                currentFileName = file.name;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    optimizeOriginalImage = new Image();
                    optimizeOriginalImage.onload = function() {
                        document.getElementById('originalOptimizeImage').src = e.target.result;
                        document.getElementById('optimizePreview').style.display = 'grid';
                        document.getElementById('optimizeControls').style.display = 'block';
                        document.getElementById('optimizeDownloadBtn').style.display = 'none';
                        
                        document.getElementById('originalOptimizeInfo').innerHTML = `
                            <strong>Dimensions:</strong> ${optimizeOriginalImage.width} Ã— ${optimizeOriginalImage.height}<br>
                            <strong>File Size:</strong> ${formatFileSize(file.size)}<br>
                            <strong>Format:</strong> ${file.type}
                        `;
                        
                        setOptimizePreset('medium');
                    };
                    optimizeOriginalImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function setOptimizePreset(size) {
            if (!optimizeOriginalImage) return;
            
            if (size === 'custom') {
                document.getElementById('optimizeCustomSize').style.display = 'block';
                return;
            }
            
            document.getElementById('optimizeCustomSize').style.display = 'none';
            
            let targetWidth;
            switch(size) {
                case 'small': targetWidth = 640; break;
                case 'medium': targetWidth = 800; break;
                case 'large': targetWidth = 1200; break;
                default: return;
            }
            
            const aspectRatio = optimizeOriginalImage.width / optimizeOriginalImage.height;
            const targetHeight = Math.round(targetWidth / aspectRatio);
            
            document.getElementById('optimizeWidth').value = targetWidth;
            document.getElementById('optimizeHeight').value = targetHeight;
        }

        function updateOptimizeQualityLabel() {
            const quality = document.getElementById('optimizeQuality').value;
            document.getElementById('optimizeQualityValue').textContent = quality + '%';
        }

        function processOptimization() {
            if (!optimizeOriginalImage) return;
            
            document.getElementById('optimizeProgress').classList.add('active');
            document.getElementById('optimizeProgressFill').style.width = '0%';
            
            const canvas = document.createElement('canvas');
            
            let width = parseInt(document.getElementById('optimizeWidth').value) || optimizeOriginalImage.width;
            let height = parseInt(document.getElementById('optimizeHeight').value) || optimizeOriginalImage.height;
            
            if (document.getElementById('optimizeKeepAspect').checked) {
                const aspectRatio = optimizeOriginalImage.width / optimizeOriginalImage.height;
                if (width) {
                    height = Math.round(width / aspectRatio);
                } else if (height) {
                    width = Math.round(height * aspectRatio);
                }
            }
            
            canvas.width = width;
            canvas.height = height;
            
            const ctx = canvas.getContext('2d');
            ctx.drawImage(optimizeOriginalImage, 0, 0, width, height);
            
            const quality = parseInt(document.getElementById('optimizeQuality').value) / 100;
            const format = document.getElementById('optimizeFormat').value;
            
            let mimeType = 'image/jpeg';
            let extension = 'jpg';
            
            if (format === 'png') {
                mimeType = 'image/png';
                extension = 'png';
            } else if (format === 'webp' || format === 'auto') {
                mimeType = 'image/webp';
                extension = 'webp';
            }
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                document.getElementById('optimizeProgressFill').style.width = progress + '%';
                document.getElementById('optimizeProgressText').textContent = `Optimizing... ${progress}%`;
                
                if (progress >= 100) {
                    clearInterval(interval);
                    
                    canvas.toBlob((blob) => {
                        processedImageBlob = blob;
                        const url = URL.createObjectURL(blob);
                        document.getElementById('optimizedImage').src = url;
                        
                        const reduction = optimizeOriginalImage.originalSize ? 
                            Math.round((1 - blob.size / optimizeOriginalImage.originalSize) * 100) : 0;
                        
                        document.getElementById('optimizedInfo').innerHTML = `
                            <strong>Dimensions:</strong> ${width} Ã— ${height}<br>
                            <strong>File Size:</strong> ${formatFileSize(blob.size)}<br>
                            <strong>Reduction:</strong> ${reduction}%<br>
                            <strong>Format:</strong> ${extension.toUpperCase()}
                        `;
                        
                        document.getElementById('optimizeDownloadBtn').style.display = 'flex';
                        document.getElementById('optimizeProgress').classList.remove('active');
                        
                        showToast('Image optimized successfully!', 'success');
                    }, mimeType, quality);
                }
            }, 50);
            
            // Store original file size
            optimizeOriginalImage.originalSize = document.getElementById('optimizeFileInput').files[0].size;
        }

        function downloadOptimizedImage() {
            if (!processedImageBlob) return;
            
            const url = URL.createObjectURL(processedImageBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'optimized_' + currentFileName.replace(/\.[^/.]+$/, '') + '.' + 
                (document.getElementById('optimizeFormat').value === 'auto' ? 'webp' : document.getElementById('optimizeFormat').value);
            link.click();
            URL.revokeObjectURL(url);
            
            showToast('Download started!', 'success');
        }

        function resetOptimizeTool() {
            document.getElementById('optimizeFileInput').value = '';
            document.getElementById('optimizePreview').style.display = 'none';
            document.getElementById('optimizeControls').style.display = 'none';
            document.getElementById('optimizeDownloadBtn').style.display = 'none';
            document.getElementById('optimizeProgress').classList.remove('active');
            optimizeOriginalImage = null;
            processedImageBlob = null;
        }

        // ============= EXIF VIEWER FUNCTIONS =============
        function handleEXIFUpload(files) {
            const container = document.getElementById('exifContainer');
            const grid = document.getElementById('exifGrid');
            const noData = document.getElementById('noExifData');
            
            grid.innerHTML = '';
            container.style.display = 'block';
            
            if (files.length === 0) {
                noData.style.display = 'block';
                return;
            }
            
            noData.style.display = 'none';
            
            Array.from(files).forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        const card = document.createElement('div');
                        card.className = 'preview-card';
                        
                        // Basic image info
                        let exifHtml = `
                            <h4 style="margin-bottom: 1rem;">
                                <i class="fas fa-image"></i> ${file.name}
                            </h4>
                            <div style="margin-bottom: 1rem;">
                                <img src="${e.target.result}" style="max-width: 100%; max-height: 200px; border-radius: 8px;">
                            </div>
                            <div class="exif-data">
                                <div class="exif-row">
                                    <span class="exif-label">File Name:</span>
                                    <span class="exif-value">${file.name}</span>
                                </div>
                                <div class="exif-row">
                                    <span class="exif-label">File Size:</span>
                                    <span class="exif-value">${formatFileSize(file.size)}</span>
                                </div>
                                <div class="exif-row">
                                    <span class="exif-label">Dimensions:</span>
                                    <span class="exif-value">${img.width} Ã— ${img.height} px</span>
                                </div>
                                <div class="exif-row">
                                    <span class="exif-label">Aspect Ratio:</span>
                                    <span class="exif-value">${(img.width / img.height).toFixed(2)}</span>
                                </div>
                                <div class="exif-row">
                                    <span class="exif-label">Megapixels:</span>
                                    <span class="exif-value">${(img.width * img.height / 1000000).toFixed(2)} MP</span>
                                </div>
                                <div class="exif-row">
                                    <span class="exif-label">File Type:</span>
                                    <span class="exif-value">${file.type || 'Unknown'}</span>
                                </div>
                                <div class="exif-row">
                                    <span class="exif-label">Last Modified:</span>
                                    <span class="exif-value">${new Date(file.lastModified).toLocaleString()}</span>
                                </div>
                            </div>
                        `;
                        
                        card.innerHTML = exifHtml;
                        grid.appendChild(card);
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            });
        }

        // ============= WATERMARK FUNCTIONS =============
        let watermarkOriginalImage = null;

        function handleWatermarkUpload(files) {
            if (files.length > 0) {
                const file = files[0];
                currentFileName = file.name;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    watermarkOriginalImage = new Image();
                    watermarkOriginalImage.onload = function() {
                        document.getElementById('originalWatermarkImage').src = e.target.result;
                        document.getElementById('watermarkPreview').style.display = 'grid';
                        document.getElementById('watermarkControls').style.display = 'block';
                        document.getElementById('watermarkDownloadBtn').style.display = 'none';
                        
                        updateWatermarkPreview();
                    };
                    watermarkOriginalImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function toggleWatermarkType() {
            const type = document.querySelector('input[name="watermarkType"]:checked').value;
            document.getElementById('textWatermarkControls').style.display = type === 'text' ? 'block' : 'none';
            document.getElementById('imageWatermarkControls').style.display = type === 'image' ? 'block' : 'none';
            updateWatermarkPreview();
        }

        function handleWatermarkImageUpload(files) {
            if (files.length > 0) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    watermarkImageData = new Image();
                    watermarkImageData.onload = function() {
                        document.getElementById('watermarkImagePreview').style.display = 'block';
                        document.getElementById('watermarkImage').src = e.target.result;
                        updateWatermarkPreview();
                    };
                    watermarkImageData.src = e.target.result;
                };
                reader.readAsDataURL(files[0]);
            }
        }

        function updateWatermarkPreview() {
            if (!watermarkOriginalImage) return;
            
            const canvas = document.createElement('canvas');
            canvas.width = watermarkOriginalImage.width;
            canvas.height = watermarkOriginalImage.height;
            
            const ctx = canvas.getContext('2d');
            ctx.drawImage(watermarkOriginalImage, 0, 0);
            
            const type = document.querySelector('input[name="watermarkType"]:checked').value;
            const position = document.getElementById('watermarkPosition').value;
            const margin = parseInt(document.getElementById('watermarkMargin').value);
            document.getElementById('marginValue').textContent = margin + 'px';
            
            ctx.save();
            
            if (type === 'text') {
                const text = document.getElementById('watermarkText').value || 'Â© FastResizePro';
                const fontSize = parseInt(document.getElementById('watermarkFontSize').value);
                document.getElementById('fontSizeValue').textContent = fontSize + 'px';
                const color = document.getElementById('watermarkColor').value;
                const opacity = parseInt(document.getElementById('watermarkOpacity').value) / 100;
                document.getElementById('opacityValue').textContent = opacity * 100 + '%';
                
                ctx.font = `bold ${fontSize}px Arial`;
                ctx.fillStyle = color;
                ctx.globalAlpha = opacity;
                
                const metrics = ctx.measureText(text);
                const textWidth = metrics.width;
                const textHeight = fontSize;
                
                let x, y;
                switch(position) {
                    case 'top-left': x = margin; y = margin + textHeight; break;
                    case 'top-right': x = canvas.width - textWidth - margin; y = margin + textHeight; break;
                    case 'center': x = (canvas.width - textWidth) / 2; y = (canvas.height + textHeight) / 2; break;
                    case 'bottom-left': x = margin; y = canvas.height - margin; break;
                    case 'bottom-right': x = canvas.width - textWidth - margin; y = canvas.height - margin; break;
                }
                
                ctx.fillText(text, x, y);
                
            } else if (type === 'image' && watermarkImageData) {
                const opacity = parseInt(document.getElementById('watermarkOpacity').value) / 100;
                ctx.globalAlpha = opacity;
                
                const scale = 0.2;
                const w = watermarkImageData.width * scale;
                const h = watermarkImageData.height * scale;
                
                let x, y;
                switch(position) {
                    case 'top-left': x = margin; y = margin; break;
                    case 'top-right': x = canvas.width - w - margin; y = margin; break;
                    case 'center': x = (canvas.width - w) / 2; y = (canvas.height - h) / 2; break;
                    case 'bottom-left': x = margin; y = canvas.height - h - margin; break;
                    case 'bottom-right': x = canvas.width - w - margin; y = canvas.height - h - margin; break;
                }
                
                ctx.drawImage(watermarkImageData, x, y, w, h);
            }
            
            ctx.restore();
            
            canvas.toBlob((blob) => {
                const url = URL.createObjectURL(blob);
                document.getElementById('watermarkedImage').src = url;
                processedImageBlob = blob;
            }, 'image/jpeg', 0.9);
        }

        function processWatermark() {
            updateWatermarkPreview();
            document.getElementById('watermarkDownloadBtn').style.display = 'flex';
            showToast('Watermark applied successfully!', 'success');
        }

        function downloadWatermarkedImage() {
            if (!processedImageBlob) return;
            
            const url = URL.createObjectURL(processedImageBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'watermarked_' + currentFileName;
            link.click();
            URL.revokeObjectURL(url);
            
            showToast('Download started!', 'success');
        }

        function resetWatermarkTool() {
            document.getElementById('watermarkFileInput').value = '';
            document.getElementById('watermarkPreview').style.display = 'none';
            document.getElementById('watermarkControls').style.display = 'none';
            document.getElementById('watermarkDownloadBtn').style.display = 'none';
            document.getElementById('watermarkImagePreview').style.display = 'none';
            watermarkOriginalImage = null;
            watermarkImageData = null;
            processedImageBlob = null;
        }

        // ============= UPSCALE IMAGE FUNCTIONS =============
        let upscaleOriginalImage = null;

        function handleUpscaleUpload(files) {
            if (files.length > 0) {
                const file = files[0];
                currentFileName = file.name;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    upscaleOriginalImage = new Image();
                    upscaleOriginalImage.onload = function() {
                        document.getElementById('originalUpscaleImage').src = e.target.result;
                        document.getElementById('upscalePreview').style.display = 'grid';
                        document.getElementById('upscaleControls').style.display = 'block';
                        document.getElementById('upscaleDownloadBtn').style.display = 'none';
                        
                        document.getElementById('originalUpscaleInfo').innerHTML = `
                            <strong>Dimensions:</strong> ${upscaleOriginalImage.width} Ã— ${upscaleOriginalImage.height}<br>
                            <strong>File Size:</strong> ${formatFileSize(file.size)}<br>
                            <strong>Format:</strong> ${file.type}
                        `;
                        
                        document.getElementById('originalUpscaleDimensions').textContent = 
                            `${upscaleOriginalImage.width} Ã— ${upscaleOriginalImage.height}`;
                        
                        setUpscaleFactor(2);
                    };
                    upscaleOriginalImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function setUpscaleFactor(factor) {
            upscaleFactor = factor;
            
            document.querySelectorAll('#upscaleControls .btn-outline').forEach(btn => {
                btn.classList.remove('btn-primary');
                btn.classList.add('btn-outline');
            });
            
            event.target.classList.remove('btn-outline');
            event.target.classList.add('btn-primary');
            
            if (upscaleOriginalImage) {
                const width = upscaleOriginalImage.width * factor;
                const height = upscaleOriginalImage.height * factor;
                document.getElementById('upscaledDimensions').textContent = `${width} Ã— ${height}`;
            }
        }

        function processUpscale() {
            if (!upscaleOriginalImage) return;
            
            document.getElementById('upscaleProgress').classList.add('active');
            document.getElementById('upscaleProgressFill').style.width = '0%';
            
            const canvas = document.createElement('canvas');
            canvas.width = upscaleOriginalImage.width * upscaleFactor;
            canvas.height = upscaleOriginalImage.height * upscaleFactor;
            
            const ctx = canvas.getContext('2d');
            
            // Apply enhancement
            const enhancement = document.getElementById('upscaleEnhance').value;
            if (enhancement === 'smooth') {
                ctx.imageSmoothingEnabled = true;
                ctx.imageSmoothingQuality = 'high';
            } else if (enhancement === 'sharp') {
                ctx.imageSmoothingEnabled = false;
            }
            
            ctx.drawImage(upscaleOriginalImage, 0, 0, canvas.width, canvas.height);
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                document.getElementById('upscaleProgressFill').style.width = progress + '%';
                document.getElementById('upscaleProgressText').textContent = `Upscaling... ${progress}%`;
                
                if (progress >= 100) {
                    clearInterval(interval);
                    
                    canvas.toBlob((blob) => {
                        processedImageBlob = blob;
                        const url = URL.createObjectURL(blob);
                        document.getElementById('upscaledImage').src = url;
                        document.getElementById('upscaledInfo').innerHTML = `
                            <strong>Dimensions:</strong> ${canvas.width} Ã— ${canvas.height}<br>
                            <strong>Upscale Factor:</strong> ${upscaleFactor}x<br>
                            <strong>Enhancement:</strong> ${enhancement}
                        `;
                        
                        document.getElementById('upscaleDownloadBtn').style.display = 'flex';
                        document.getElementById('upscaleProgress').classList.remove('active');
                        
                        showToast(`Image upscaled ${upscaleFactor}x!`, 'success');
                    }, 'image/jpeg', 0.95);
                }
            }, 50);
        }

        function downloadUpscaledImage() {
            if (!processedImageBlob) return;
            
            const url = URL.createObjectURL(processedImageBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'upscaled_' + upscaleFactor + 'x_' + currentFileName;
            link.click();
            URL.revokeObjectURL(url);
            
            showToast('Download started!', 'success');
        }

        function resetUpscaleTool() {
            document.getElementById('upscaleFileInput').value = '';
            document.getElementById('upscalePreview').style.display = 'none';
            document.getElementById('upscaleControls').style.display = 'none';
            document.getElementById('upscaleDownloadBtn').style.display = 'none';
            document.getElementById('upscaleProgress').classList.remove('active');
            upscaleOriginalImage = null;
            processedImageBlob = null;
        }

        // ============= CONVERT TO WEBP FUNCTIONS =============
        let webpOriginalImage = null;

        function handleWebPUpload(files) {
            if (files.length > 0) {
                const file = files[0];
                currentFileName = file.name;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    webpOriginalImage = new Image();
                    webpOriginalImage.onload = function() {
                        document.getElementById('originalWebPImage').src = e.target.result;
                        document.getElementById('webpPreview').style.display = 'grid';
                        document.getElementById('webpControls').style.display = 'block';
                        document.getElementById('webpDownloadBtn').style.display = 'none';
                        
                        document.getElementById('originalWebPInfo').innerHTML = `
                            <strong>Dimensions:</strong> ${webpOriginalImage.width} Ã— ${webpOriginalImage.height}<br>
                            <strong>File Size:</strong> ${formatFileSize(file.size)}<br>
                            <strong>Format:</strong> ${file.type}
                        `;
                    };
                    webpOriginalImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function updateWebPControls() {
            const format = document.getElementById('webpFormat').value;
            document.getElementById('webpQualityControl').style.display = format !== 'png' ? 'block' : 'none';
        }

        function updateWebPQualityLabel() {
            const quality = document.getElementById('webpQuality').value;
            document.getElementById('webpQualityValue').textContent = quality + '%';
        }

        function toggleWebPResize() {
            const enabled = document.getElementById('webpResize').checked;
            document.getElementById('webpResizeControls').style.display = enabled ? 'block' : 'none';
        }

        function processWebPConversion() {
            if (!webpOriginalImage) return;
            
            document.getElementById('webpProgress').classList.add('active');
            document.getElementById('webpProgressFill').style.width = '0%';
            
            const canvas = document.createElement('canvas');
            
            if (document.getElementById('webpResize').checked) {
                let width = parseInt(document.getElementById('webpWidth').value) || webpOriginalImage.width;
                let height = parseInt(document.getElementById('webpHeight').value) || webpOriginalImage.height;
                
                if (document.getElementById('webpKeepAspect').checked) {
                    const aspectRatio = webpOriginalImage.width / webpOriginalImage.height;
                    if (width) {
                        height = Math.round(width / aspectRatio);
                    } else if (height) {
                        width = Math.round(height * aspectRatio);
                    }
                }
                
                canvas.width = width;
                canvas.height = height;
            } else {
                canvas.width = webpOriginalImage.width;
                canvas.height = webpOriginalImage.height;
            }
            
            const ctx = canvas.getContext('2d');
            ctx.drawImage(webpOriginalImage, 0, 0, canvas.width, canvas.height);
            
            const format = document.getElementById('webpFormat').value;
            const quality = parseInt(document.getElementById('webpQuality').value) / 100;
            
            let mimeType, extension;
            switch(format) {
                case 'webp':
                    mimeType = 'image/webp';
                    extension = 'webp';
                    break;
                case 'png':
                    mimeType = 'image/png';
                    extension = 'png';
                    break;
                case 'jpg':
                    mimeType = 'image/jpeg';
                    extension = 'jpg';
                    break;
            }
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                document.getElementById('webpProgressFill').style.width = progress + '%';
                document.getElementById('webpProgressText').textContent = `Converting... ${progress}%`;
                
                if (progress >= 100) {
                    clearInterval(interval);
                    
                    canvas.toBlob((blob) => {
                        processedImageBlob = blob;
                        const url = URL.createObjectURL(blob);
                        document.getElementById('convertedWebPImage').src = url;
                        
                        const reduction = webpOriginalImage.originalSize ? 
                            Math.round((1 - blob.size / webpOriginalImage.originalSize) * 100) : 0;
                        
                        document.getElementById('convertedWebPInfo').innerHTML = `
                            <strong>Dimensions:</strong> ${canvas.width} Ã— ${canvas.height}<br>
                            <strong>File Size:</strong> ${formatFileSize(blob.size)}<br>
                            <strong>Format:</strong> ${extension.toUpperCase()}<br>
                            <strong>Reduction:</strong> ${reduction}%
                        `;
                        
                        document.getElementById('webpDownloadBtn').style.display = 'flex';
                        document.getElementById('webpProgress').classList.remove('active');
                        
                        showToast(`Converted to ${extension.toUpperCase()}!`, 'success');
                    }, mimeType, format === 'png' ? undefined : quality);
                }
            }, 50);
            
            // Store original file size
            webpOriginalImage.originalSize = document.getElementById('webpFileInput').files[0].size;
        }

        function downloadWebPImage() {
            if (!processedImageBlob) return;
            
            const format = document.getElementById('webpFormat').value;
            const extension = format === 'webp' ? 'webp' : (format === 'png' ? 'png' : 'jpg');
            
            const url = URL.createObjectURL(processedImageBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'converted_' + currentFileName.replace(/\.[^/.]+$/, '') + '.' + extension;
            link.click();
            URL.revokeObjectURL(url);
            
            showToast('Download started!', 'success');
        }

        function resetWebPTool() {
            document.getElementById('webpFileInput').value = '';
            document.getElementById('webpPreview').style.display = 'none';
            document.getElementById('webpControls').style.display = 'none';
            document.getElementById('webpDownloadBtn').style.display = 'none';
            document.getElementById('webpProgress').classList.remove('active');
            webpOriginalImage = null;
            processedImageBlob = null;
        }

        // ============= BATCH RESIZE FUNCTIONS =============
        function handleBatchUpload(files) {
            batchFiles = Array.from(files);
            
            const fileList = document.getElementById('batchFileItems');
            fileList.innerHTML = batchFiles.map((file, index) => `
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; border-bottom: 1px solid var(--gray-light);">
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-image" style="color: var(--primary);"></i>
                        <span>${file.name}</span>
                        <span style="font-size: 0.8rem; color: var(--gray);">${formatFileSize(file.size)}</span>
                    </div>
                    <button class="btn btn-outline" style="padding: 0.25rem 0.5rem;" onclick="removeBatchFile(${index})">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `).join('');
            
            document.getElementById('batchFileList').style.display = 'block';
            document.getElementById('batchControls').style.display = 'block';
            document.getElementById('batchDownloadBtn').style.display = 'none';
        }

        function removeBatchFile(index) {
            batchFiles.splice(index, 1);
            handleBatchUpload(batchFiles);
            
            if (batchFiles.length === 0) {
                document.getElementById('batchFileList').style.display = 'none';
                document.getElementById('batchControls').style.display = 'none';
            }
        }

        function updateBatchPercentageLabel() {
            const percentage = document.getElementById('batchPercentage').value;
            document.getElementById('batchPercentageValue').textContent = percentage + '%';
        }

        function updateBatchQualityLabel() {
            const quality = document.getElementById('batchQuality').value;
            document.getElementById('batchQualityValue').textContent = quality + '%';
        }

        function processBatchResize() {
            if (batchFiles.length === 0) return;
            
            document.getElementById('batchProgress').classList.add('active');
            document.getElementById('batchProgressFill').style.width = '0%';
            
            const mode = document.getElementById('batchResizeMode').value;
            const quality = parseInt(document.getElementById('batchQuality').value) / 100;
            const format = document.getElementById('batchFormat').value;
            
            const zip = new JSZip();
            batchProcessedBlobs = [];
            
            let processed = 0;
            
            batchFiles.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        
                        // Apply resize based on mode
                        if (mode === 'percentage') {
                            const percentage = parseInt(document.getElementById('batchPercentage').value) / 100;
                            canvas.width = Math.round(img.width * percentage);
                            canvas.height = Math.round(img.height * percentage);
                        } else if (mode === 'dimensions') {
                            canvas.width = parseInt(document.getElementById('batchWidth').value) || img.width;
                            canvas.height = parseInt(document.getElementById('batchHeight').value) || img.height;
                        } else if (mode === 'width') {
                            const width = parseInt(document.getElementById('batchWidth').value) || img.width;
                            canvas.width = width;
                            canvas.height = Math.round(width * (img.height / img.width));
                        } else if (mode === 'height') {
                            const height = parseInt(document.getElementById('batchHeight').value) || img.height;
                            canvas.height = height;
                            canvas.width = Math.round(height * (img.width / img.height));
                        }
                        
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                        
                        let mimeType = 'image/jpeg';
                        let extension = 'jpg';
                        
                        if (format === 'png') {
                            mimeType = 'image/png';
                            extension = 'png';
                        } else if (format === 'webp') {
                            mimeType = 'image/webp';
                            extension = 'webp';
                        } else {
                            // Keep original format
                            extension = file.name.split('.').pop();
                            mimeType = file.type;
                        }
                        
                        canvas.toBlob((blob) => {
                            batchProcessedBlobs[index] = blob;
                            
                            // Add to zip
                            zip.file(`resized_${index + 1}_${file.name.replace(/\.[^/.]+$/, '')}.${extension}`, blob);
                            
                            processed++;
                            const progress = Math.round((processed / batchFiles.length) * 100);
                            
                            document.getElementById('batchProgressFill').style.width = progress + '%';
                            document.getElementById('batchProgressText').textContent = 
                                `${processed}/${batchFiles.length} files processed`;
                            document.getElementById('batchProgressPercent').textContent = progress + '%';
                            
                            if (processed === batchFiles.length) {
                                // Generate zip
                                zip.generateAsync({ type: 'blob' }).then((content) => {
                                    batchProcessedBlobs.zipFile = content;
                                    document.getElementById('batchDownloadBtn').style.display = 'flex';
                                    document.getElementById('batchProgress').classList.remove('active');
                                    
                                    showToast(`Processed ${batchFiles.length} files!`, 'success');
                                });
                            }
                        }, mimeType, quality);
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            });
        }

        function downloadBatchZip() {
            if (!batchProcessedBlobs.zipFile) return;
            
            const url = URL.createObjectURL(batchProcessedBlobs.zipFile);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'resized_images.zip';
            link.click();
            URL.revokeObjectURL(url);
            
            showToast('ZIP download started!', 'success');
        }

        function resetBatchTool() {
            document.getElementById('batchFileInput').value = '';
            document.getElementById('batchFileList').style.display = 'none';
            document.getElementById('batchControls').style.display = 'none';
            document.getElementById('batchDownloadBtn').style.display = 'none';
            document.getElementById('batchProgress').classList.remove('active');
            batchFiles = [];
            batchProcessedBlobs = [];
        }

        // Initialize all dropdown listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Load aspect presets
            loadAspectPresets();
            
            // Initialize dimension calculator
            calculateDimensions();
            
            // Set up resize mode listeners
            document.getElementById('batchResizeMode').addEventListener('change', function(e) {
                const mode = e.target.value;
                document.getElementById('batchPercentageControl').style.display = mode === 'percentage' ? 'block' : 'none';
                document.getElementById('batchDimensionsControl').style.display = 
                    ['dimensions', 'width', 'height'].includes(mode) ? 'block' : 'none';
            });
            
            // Initialize all quality labels
            updateCompressQualityLabel();
            updateOptimizeQualityLabel();
            updateWebPQualityLabel();
            updateBatchPercentageLabel();
            updateBatchQualityLabel();
        });
    </script>
</body>
</html>


